import{r as i,d as y,j as e}from"./index-DZAlsvLE.js";import{c as A,y as C,b as T,e as S,B as f}from"./AdminLayout-D12jS9pN.js";import{C as c,d as o,I as L,B}from"./card-DfuB3kKO.js";import{T as _,a as P,b as m,c as a,d as D,e as t}from"./table-DSRtfemy.js";import{i as E}from"./admissionService-DJUryvmI.js";import{P as R}from"./plus-j_V7wq7w.js";import{L as U}from"./loader-circle-ONSjYwRk.js";const G=()=>{const[l,p]=i.useState([]),[x,h]=i.useState(!0),[d,N]=i.useState(""),{toast:g}=y();i.useEffect(()=>{w()},[]);const w=async()=>{var s,n;try{h(!0);const v=((await E.getAll({limit:100})).data||[]).filter(j=>j.status==="Admitted"||j.status==="Active");p(v)}catch(r){g({title:"Error",description:((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load admissions",variant:"destructive"})}finally{h(!1)}},u=l.filter(s=>{var n,r;return((n=s.patient_name)==null?void 0:n.toLowerCase().includes(d.toLowerCase()))||((r=s.admission_number)==null?void 0:r.toLowerCase().includes(d.toLowerCase()))}),b=s=>s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A";return e.jsxs(A,{title:"Admissions",subtitle:"New patient admissions",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(c,{children:e.jsx(o,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Today's Admissions"}),e.jsx("p",{className:"text-3xl font-bold",children:l.length})]}),e.jsx(C,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(c,{children:e.jsx(o,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Bed Assignment"}),e.jsx("p",{className:"text-3xl font-bold text-warning",children:l.filter(s=>!s.bed_id).length})]}),e.jsx(T,{className:"w-8 h-8 text-warning"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(L,{placeholder:"Search admissions...",className:"pl-10",value:d,onChange:s=>N(s.target.value)})]}),e.jsxs(B,{className:"gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"New Admission"]})]}),e.jsx(c,{children:e.jsx(o,{className:"p-0",children:x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(_,{children:[e.jsx(P,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Admission No."}),e.jsx(a,{children:"Patient"}),e.jsx(a,{children:"Ward/Bed"}),e.jsx(a,{children:"Admission Date"}),e.jsx(a,{children:"Reason"}),e.jsx(a,{children:"Status"})]})}),e.jsxs(D,{children:[u.map(s=>e.jsxs(m,{children:[e.jsx(t,{className:"font-mono text-sm",children:s.admission_number}),e.jsx(t,{className:"font-medium",children:s.patient_name||"Unknown"}),e.jsx(t,{children:e.jsxs(f,{variant:"secondary",children:[s.ward_name||"Pending"," / ",s.bed_number||"Pending"]})}),e.jsx(t,{children:b(s.admission_date)}),e.jsx(t,{className:"max-w-[200px] truncate",children:s.reason||"N/A"}),e.jsx(t,{children:e.jsx(f,{variant:"outline",className:"border-success text-success",children:s.status})})]},s.id)),u.length===0&&!x&&e.jsx(m,{children:e.jsx(t,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No active admissions"})})]})]})})})]})};export{G as default};
