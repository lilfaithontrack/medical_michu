import{c as H,r as m,j as e,i as p,d as R}from"./index-DZAlsvLE.js";import{c as G,e as X,C as I,A as J,a as K,B as Q,D as W,f as Y,g as Z,h as D}from"./AdminLayout-D12jS9pN.js";import{I as y,B as N,C as ee,d as te}from"./card-DfuB3kKO.js";import{T as se,a as ae,b as T,c as x,d as ne,e as h}from"./table-DSRtfemy.js";import{D as re,a as ie,b as le,c as oe,S as F,d as L,e as k,f as E,g,h as ce,E as de,i as pe,T as me,j as ue}from"./DeleteConfirmDialog-DI90Viws.js";import{L as j}from"./label-B7mPZteH.js";import{F as he}from"./filter-Dy4-oP81.js";import{P as xe}from"./plus-j_V7wq7w.js";import{L as je}from"./loader-circle-ONSjYwRk.js";import{C as P}from"./circle-check-big-C2wm8AGO.js";import"./index-BF5NQnWb.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=H("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ge=["Check-up","Follow-up","Consultation","Surgery Prep","Lab Results","Emergency"],fe=["Cardiology","Neurology","Pediatrics","Orthopedics","Dermatology","General"],$={patient:"",doctor:"",date:new Date().toISOString().split("T")[0],time:"09:00 AM",type:"Check-up",status:"Scheduled",department:"General"};function ve({open:a,onOpenChange:o,appointment:n,onSave:f}){const[r,d]=m.useState($);m.useEffect(()=>{d(n?{patient:n.patient,doctor:n.doctor,date:n.date,time:n.time,type:n.type,status:n.status,department:n.department}:$)},[n,a]);const S=s=>{s.preventDefault(),f(n?{...r,id:n.id}:r),o(!1)};return e.jsx(re,{open:a,onOpenChange:o,children:e.jsxs(ie,{className:"sm:max-w-[500px]",children:[e.jsx(le,{children:e.jsx(oe,{children:n?"Edit Appointment":"New Appointment"})}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"patient",children:"Patient Name"}),e.jsx(y,{id:"patient",value:r.patient,onChange:s=>d({...r,patient:s.target.value}),required:!0,maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"doctor",children:"Doctor"}),e.jsx(y,{id:"doctor",value:r.doctor,onChange:s=>d({...r,doctor:s.target.value}),placeholder:"Dr. Smith",required:!0,maxLength:100})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"date",children:"Date"}),e.jsx(y,{id:"date",type:"date",value:r.date,onChange:s=>d({...r,date:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"time",children:"Time"}),e.jsx(y,{id:"time",value:r.time,onChange:s=>d({...r,time:s.target.value}),placeholder:"09:00 AM",required:!0,maxLength:10})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"type",children:"Type"}),e.jsxs(F,{value:r.type,onValueChange:s=>d({...r,type:s}),children:[e.jsx(L,{children:e.jsx(k,{})}),e.jsx(E,{children:ge.map(s=>e.jsx(g,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"department",children:"Department"}),e.jsxs(F,{value:r.department,onValueChange:s=>d({...r,department:s}),children:[e.jsx(L,{children:e.jsx(k,{})}),e.jsx(E,{children:fe.map(s=>e.jsx(g,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"status",children:"Status"}),e.jsxs(F,{value:r.status,onValueChange:s=>d({...r,status:s}),children:[e.jsx(L,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(g,{value:"Scheduled",children:"Scheduled"}),e.jsx(g,{value:"Confirmed",children:"Confirmed"}),e.jsx(g,{value:"Completed",children:"Completed"}),e.jsx(g,{value:"Cancelled",children:"Cancelled"})]})]})]})]}),e.jsxs(ce,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(N,{type:"submit",children:[n?"Update":"Create"," Appointment"]})]})]})]})})}const C={async getAll(a={}){return(await p.get("/appointments",{params:a})).data},async getById(a){return(await p.get(`/appointments/${a}`)).data.data},async create(a){return(await p.post("/appointments",a)).data.data},async update(a,o){return(await p.put(`/appointments/${a}`,o)).data.data},async updateStatus(a,o){return(await p.put(`/appointments/${a}/status`,{status:o})).data.data},async cancel(a){await p.delete(`/appointments/${a}`)},async getToday(){return(await p.get("/appointments/today")).data.data},async getByDate(a){return(await p.get(`/appointments/date/${a}`)).data.data},async getAvailableSlots(a,o,n=30){return(await p.get("/appointments/available-slots",{params:{doctor_id:a,date:o,duration:n}})).data.data},async getStats(a,o){return(await p.get("/appointments/stats",{params:{startDate:a,endDate:o}})).data.data}},Ce={Scheduled:"bg-info/10 text-info border-info/20",Confirmed:"bg-success/10 text-success border-success/20",Completed:"bg-muted text-muted-foreground border-border",Cancelled:"bg-destructive/10 text-destructive border-destructive/20","In Progress":"bg-warning/10 text-warning border-warning/20","No Show":"bg-destructive/10 text-destructive border-destructive/20"},ye={Scheduled:I,Confirmed:P,Completed:P,Cancelled:_,"In Progress":I,"No Show":_},Ie=()=>{const[a,o]=m.useState([]),[n,f]=m.useState(!0),[r,d]=m.useState(""),[S,s]=m.useState(!1),[B,b]=m.useState(!1),[A,v]=m.useState(null),{toast:u}=R();m.useEffect(()=>{w()},[]);const w=async()=>{var t,l;try{f(!0);const i=await C.getAll({limit:100});o(i.data||[])}catch(i){u({title:"Error",description:((l=(t=i.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to load appointments",variant:"destructive"})}finally{f(!1)}},M=a.filter(t=>{var l,i,c;return((l=t.patient_name)==null?void 0:l.toLowerCase().includes(r.toLowerCase()))||((i=t.doctor_name)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))||((c=t.appointment_id)==null?void 0:c.toLowerCase().includes(r.toLowerCase()))}),q=async t=>{var l,i;try{t.id?(await C.update(t.id,t),u({title:"Appointment Updated",description:"Appointment has been updated."})):(await C.create(t),u({title:"Appointment Created",description:"New appointment has been scheduled."})),w(),v(null),s(!1)}catch(c){u({title:"Error",description:((i=(l=c.response)==null?void 0:l.data)==null?void 0:i.message)||"Failed to save appointment",variant:"destructive"})}},O=async()=>{var t,l;if(A)try{await C.cancel(A.id),u({title:"Appointment Cancelled",description:"Appointment has been removed.",variant:"destructive"}),w(),v(null)}catch(i){u({title:"Error",description:((l=(t=i.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to cancel appointment",variant:"destructive"})}b(!1)},U=async t=>{var l,i;try{await C.updateStatus(t.id,"Completed"),u({title:"Appointment Completed",description:"Appointment marked as complete."}),w()}catch(c){u({title:"Error",description:((i=(l=c.response)==null?void 0:l.data)==null?void 0:i.message)||"Failed to update status",variant:"destructive"})}},V=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",z=t=>{if(!t)return"";const[l,i]=t.split(":"),c=parseInt(l);return`${c>12?c-12:c}:${i} ${c>=12?"PM":"AM"}`};return e.jsxs(G,{title:"Appointments",subtitle:"Manage patient appointments and schedules",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(X,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(y,{placeholder:"Search appointments...",className:"pl-10",value:r,onChange:t=>d(t.target.value)})]}),e.jsx(N,{variant:"outline",size:"icon",children:e.jsx(he,{className:"w-4 h-4"})})]}),e.jsxs(N,{className:"gap-2",onClick:()=>{v(null),s(!0)},children:[e.jsx(xe,{className:"w-4 h-4"}),"New Appointment"]})]}),e.jsx(ee,{children:e.jsx(te,{className:"p-0",children:n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(je,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(T,{children:[e.jsx(x,{children:"ID"}),e.jsx(x,{children:"Patient"}),e.jsx(x,{children:"Doctor"}),e.jsx(x,{children:"Date & Time"}),e.jsx(x,{children:"Type"}),e.jsx(x,{children:"Status"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsxs(ne,{children:[M.map(t=>{var i;const l=ye[t.status]||I;return e.jsxs(T,{className:"group",children:[e.jsx(h,{className:"font-mono text-sm",children:t.appointment_id}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"h-8 w-8",children:e.jsx(K,{className:"bg-primary/10 text-primary text-xs",children:((i=t.patient_name)==null?void 0:i.split(" ").map(c=>c[0]).join("").substring(0,2))||"P"})}),e.jsx("span",{className:"font-medium",children:t.patient_name||"Unknown"})]})}),e.jsx(h,{className:"text-muted-foreground",children:t.doctor_name||"Unassigned"}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:V(t.appointment_date)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:z(t.appointment_time)})]})}),e.jsx(h,{children:t.type||"Consultation"}),e.jsx(h,{children:e.jsxs(Q,{variant:"outline",className:`gap-1 ${Ce[t.status]||""}`,children:[e.jsx(l,{className:"w-3 h-3"}),t.status]})}),e.jsx(h,{className:"text-right",children:e.jsxs(W,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:e.jsx(de,{className:"w-4 h-4"})})}),e.jsxs(Z,{align:"end",children:[e.jsxs(D,{className:"gap-2",onClick:()=>{v(t),s(!0)},children:[e.jsx(pe,{className:"w-4 h-4"})," Edit"]}),t.status!=="Completed"&&t.status!=="Cancelled"&&e.jsxs(D,{className:"gap-2",onClick:()=>U(t),children:[e.jsx(P,{className:"w-4 h-4"})," Mark Complete"]}),e.jsxs(D,{className:"gap-2 text-destructive",onClick:()=>{v(t),b(!0)},children:[e.jsx(me,{className:"w-4 h-4"})," Cancel"]})]})]})})]},t.id)}),M.length===0&&!n&&e.jsx(T,{children:e.jsx(h,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No appointments found"})})]})]})})}),e.jsx(ve,{open:S,onOpenChange:s,appointment:A,onSave:q}),e.jsx(ue,{open:B,onOpenChange:b,title:"Cancel Appointment",description:"Cancel this appointment?",onConfirm:O})]})};export{Ie as default};
