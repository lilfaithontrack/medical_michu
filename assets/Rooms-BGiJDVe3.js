import{r as d,d as je,j as e}from"./index-tth2k9CU.js";import{c as fe,j as ge,b as P,S as be,B as R,D as ve,e as ye,f as Ne,g as k}from"./AdminLayout-U44WIgB_.js";import{C as j,d as f,B as x,a as we,b as Se}from"./card-gkoDvYc5.js";import{I as g}from"./Combination-CeQr3D6T.js";import{L as c}from"./label-CNduHzpQ.js";import{E as Ce,S as _e,T as Be,D as q,a as z,b as J,c as K,f as Q,d as X,e as De}from"./DeleteConfirmDialog-DJuG0Jjg.js";import{S as D,a as W,b as A,c as F,d as h}from"./select-D4_ucizz.js";import{r as o}from"./facilityService-CvZFxei7.js";import{P as L}from"./plus-fTrWKLyY.js";import{L as I}from"./loader-circle-CK8n1wqF.js";import"./index-DxvSPcIO.js";const We=["General","Private","Semi-Private","ICU","Pediatric","Maternity","Surgical","Emergency"],Ae=["Available","Occupied","Maintenance","Reserved"],$e=()=>{const[Fe,Y]=d.useState([]),[w,Z]=d.useState([]),[S,ee]=d.useState([]),[M,V]=d.useState(!0),[U,se]=d.useState(""),[ae,b]=d.useState(!1),[te,C]=d.useState(!1),[le,E]=d.useState(!1),[i,v]=d.useState(null),[_,T]=d.useState(!1),[y,u]=d.useState(!1),[O,re]=d.useState("ward"),{toast:n}=je(),[l,p]=d.useState({name:"",type:"",floor:"",total_beds:"",description:""}),[r,m]=d.useState({bed_number:"",ward_id:"",bed_type:"Standard",status:"Available",daily_rate:""});d.useEffect(()=>{B()},[]);const B=async()=>{var s,a;try{V(!0);const[t,N,pe]=await Promise.all([o.getAllRooms({limit:100}).catch(()=>({data:[]})),o.getAllWards({limit:100}).catch(()=>({data:[]})),o.getAllBeds({limit:200}).catch(()=>({data:[]}))]);Y(t.data||[]),Z(N.data||[]),ee(pe.data||[])}catch(t){n({title:"Error",description:((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to load room data",variant:"destructive"})}finally{V(!1)}},$=()=>{p({name:"",type:"",floor:"",total_beds:"",description:""}),v(null),T(!1)},G=()=>{m({bed_number:"",ward_id:"",bed_type:"Standard",status:"Available",daily_rate:""}),v(null),T(!1)},de=()=>{$(),b(!0)},ie=s=>{var a,t;v(s),T(!0),p({name:s.name||"",type:s.type||"",floor:((a=s.floor)==null?void 0:a.toString())||"",total_beds:((t=s.total_beds)==null?void 0:t.toString())||"",description:s.description||""}),b(!0)},H=s=>{G(),s&&m(a=>({...a,ward_id:s})),C(!0)},ne=(s,a)=>{v(s),re(a),E(!0)},ce=async()=>{var s,a;if(!l.name||!l.type){n({title:"Error",description:"Please fill ward name and type",variant:"destructive"});return}try{u(!0);const t={...l,floor:l.floor?parseInt(l.floor):1,total_beds:l.total_beds?parseInt(l.total_beds):0};_&&i?(await o.updateWard(i.id,t),n({title:"Success",description:"Ward updated successfully"})):(await o.createWard(t),n({title:"Success",description:"Ward added successfully"})),b(!1),$(),B()}catch(t){n({title:"Error",description:((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Operation failed",variant:"destructive"})}finally{u(!1)}},oe=async()=>{var s,a;if(!r.bed_number||!r.ward_id){n({title:"Error",description:"Please fill bed number and select ward",variant:"destructive"});return}try{u(!0);const t={...r,daily_rate:r.daily_rate?parseFloat(r.daily_rate):null};await o.createBed(t),n({title:"Success",description:"Bed added successfully"}),C(!1),G(),B()}catch(t){n({title:"Error",description:((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Operation failed",variant:"destructive"})}finally{u(!1)}},me=async()=>{var s,a;if(i)try{u(!0),O==="ward"?(await o.deleteWard(i.id),n({title:"Success",description:"Ward deleted successfully"})):(await o.deleteBed(i.id),n({title:"Success",description:"Bed deleted successfully"})),E(!1),v(null),B()}catch(t){n({title:"Error",description:((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete",variant:"destructive"})}finally{u(!1)}},xe=S.length,he=S.filter(s=>s.status==="Available").length,ue=S.filter(s=>s.status==="Occupied").length;return e.jsxs(fe,{title:"Rooms & Wards",subtitle:"Manage hospital rooms, wards, and beds",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(j,{children:e.jsx(f,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Wards"}),e.jsx("p",{className:"text-3xl font-bold",children:w.length})]}),e.jsx(ge,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(j,{children:e.jsx(f,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Beds"}),e.jsx("p",{className:"text-3xl font-bold",children:xe})]}),e.jsx(P,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(j,{children:e.jsx(f,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available"}),e.jsx("p",{className:"text-3xl font-bold text-success",children:he})]}),e.jsx(P,{className:"w-8 h-8 text-success"})]})})}),e.jsx(j,{children:e.jsx(f,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Occupied"}),e.jsx("p",{className:"text-3xl font-bold text-warning",children:ue})]}),e.jsx(P,{className:"w-8 h-8 text-warning"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search wards...",className:"pl-10",value:U,onChange:s=>se(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",className:"gap-2",onClick:()=>H(),children:[e.jsx(L,{className:"w-4 h-4"}),"Add Bed"]}),e.jsxs(x,{className:"gap-2",onClick:de,children:[e.jsx(L,{className:"w-4 h-4"}),"Add Ward"]})]})]}),M?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[w.filter(s=>{var a;return(a=s.name)==null?void 0:a.toLowerCase().includes(U.toLowerCase())}).map(s=>{const t=S.filter(N=>N.ward_id===s.id).filter(N=>N.status==="Available").length;return e.jsxs(j,{className:"group",children:[e.jsx(we,{className:"pb-2",children:e.jsxs(Se,{className:"text-lg flex items-center justify-between",children:[e.jsx("span",{children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{variant:"outline",children:["Floor ",s.floor]}),e.jsxs(ve,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100",children:e.jsx(Ce,{className:"w-4 h-4"})})}),e.jsxs(Ne,{align:"end",children:[e.jsxs(k,{className:"gap-2",onClick:()=>ie(s),children:[e.jsx(_e,{className:"w-4 h-4"})," Edit Ward"]}),e.jsxs(k,{className:"gap-2",onClick:()=>H(s.id),children:[e.jsx(L,{className:"w-4 h-4"})," Add Bed"]}),e.jsxs(k,{className:"gap-2 text-destructive",onClick:()=>ne(s,"ward"),children:[e.jsx(Be,{className:"w-4 h-4"})," Delete"]})]})]})]})]})}),e.jsxs(f,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Type"}),e.jsx(R,{variant:"secondary",children:s.type})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Beds"}),e.jsx("span",{className:"font-medium",children:s.total_beds})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Available"}),e.jsx(R,{variant:"outline",className:t>0?"border-success text-success":"border-destructive text-destructive",children:s.available_beds||t})]})]})]},s.id)}),w.length===0&&!M&&e.jsx(j,{className:"col-span-full",children:e.jsx(f,{className:"py-8 text-center text-muted-foreground",children:"No wards found"})})]}),e.jsx(q,{open:ae,onOpenChange:b,children:e.jsxs(z,{className:"max-w-md",children:[e.jsxs(J,{children:[e.jsx(K,{children:_?"Edit Ward":"Add New Ward"}),e.jsx(Q,{children:_?"Update ward details":"Add a new ward to the hospital"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Ward Name *"}),e.jsx(g,{id:"name",value:l.name,onChange:s=>p({...l,name:s.target.value}),placeholder:"e.g., General Ward A"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"type",children:"Ward Type *"}),e.jsxs(D,{value:l.type,onValueChange:s=>p({...l,type:s}),children:[e.jsx(W,{children:e.jsx(A,{placeholder:"Select type"})}),e.jsx(F,{children:We.map(s=>e.jsx(h,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"floor",children:"Floor"}),e.jsx(g,{id:"floor",type:"number",value:l.floor,onChange:s=>p({...l,floor:s.target.value}),placeholder:"1"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"total_beds",children:"Total Beds"}),e.jsx(g,{id:"total_beds",type:"number",value:l.total_beds,onChange:s=>p({...l,total_beds:s.target.value}),placeholder:"Number of beds"})]})]}),e.jsxs(X,{children:[e.jsx(x,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsxs(x,{onClick:ce,disabled:y,children:[y&&e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),_?"Update":"Add"," Ward"]})]})]})}),e.jsx(q,{open:te,onOpenChange:C,children:e.jsxs(z,{className:"max-w-md",children:[e.jsxs(J,{children:[e.jsx(K,{children:"Add New Bed"}),e.jsx(Q,{children:"Add a new bed to a ward"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"ward_id",children:"Ward *"}),e.jsxs(D,{value:r.ward_id,onValueChange:s=>m({...r,ward_id:s}),children:[e.jsx(W,{children:e.jsx(A,{placeholder:"Select ward"})}),e.jsx(F,{children:w.map(s=>e.jsx(h,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"bed_number",children:"Bed Number *"}),e.jsx(g,{id:"bed_number",value:r.bed_number,onChange:s=>m({...r,bed_number:s.target.value}),placeholder:"e.g., B-101"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"bed_type",children:"Bed Type"}),e.jsxs(D,{value:r.bed_type,onValueChange:s=>m({...r,bed_type:s}),children:[e.jsx(W,{children:e.jsx(A,{placeholder:"Select"})}),e.jsxs(F,{children:[e.jsx(h,{value:"Standard",children:"Standard"}),e.jsx(h,{value:"Electric",children:"Electric"}),e.jsx(h,{value:"Pediatric",children:"Pediatric"}),e.jsx(h,{value:"ICU",children:"ICU"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs(D,{value:r.status,onValueChange:s=>m({...r,status:s}),children:[e.jsx(W,{children:e.jsx(A,{placeholder:"Select"})}),e.jsx(F,{children:Ae.map(s=>e.jsx(h,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"daily_rate",children:"Daily Rate (ETB)"}),e.jsx(g,{id:"daily_rate",type:"number",value:r.daily_rate,onChange:s=>m({...r,daily_rate:s.target.value}),placeholder:"0.00"})]})]})]}),e.jsxs(X,{children:[e.jsx(x,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsxs(x,{onClick:oe,disabled:y,children:[y&&e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Add Bed"]})]})]})}),e.jsx(De,{open:le,onOpenChange:E,onConfirm:me,title:`Delete ${O==="ward"?"Ward":"Bed"}`,description:`Are you sure you want to delete ${O==="ward"?i==null?void 0:i.name:`bed ${i==null?void 0:i.bed_number}`}?`,loading:y})]})};export{$e as default};
