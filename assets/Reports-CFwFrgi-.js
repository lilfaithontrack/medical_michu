import{f as d,r as x,d as q,j as e}from"./index-MFUeX4KC.js";import{c as V,d as z,F as G,P as J,B as K}from"./AdminLayout-CEyGcOXW.js";import{C as i,d as o,a as w,b as S}from"./card--ujVzSXa.js";import{T as _,a as C,b as m,c as n,d as T,e as c}from"./table-tgADzikB.js";import{L as Q}from"./loader-circle-DYBsGSuP.js";import{U as W}from"./Combination-CVDpaV-S.js";import{U as X}from"./user-check-BxacW4wR.js";import{B as Y}from"./boxes-iUNL2MtH.js";import{S as Z}from"./star-C-Hz5Rws.js";const f={getDashboardStats:async()=>{var r,g,a,j,p,h,u,b;const[s,y,l,v]=await Promise.all([d.get("/patients?limit=1").catch(()=>({data:{pagination:{total:0}}})),d.get("/doctors?limit=1").catch(()=>({data:{pagination:{total:0}}})),d.get("/appointments?limit=1").catch(()=>({data:{pagination:{total:0}}})),d.get("/bills?limit=1").catch(()=>({data:{pagination:{total:0}}}))]);return{patients:((g=(r=s.data)==null?void 0:r.pagination)==null?void 0:g.total)||0,doctors:((j=(a=y.data)==null?void 0:a.pagination)==null?void 0:j.total)||0,appointments:((h=(p=l.data)==null?void 0:p.pagination)==null?void 0:h.total)||0,bills:((b=(u=v.data)==null?void 0:u.pagination)==null?void 0:b.total)||0}},getInventoryStats:async()=>(await d.get("/inventory/stats")).data,getAssetStats:async()=>(await d.get("/assets/stats")).data,getFeedbackStats:async()=>(await d.get("/feedback/stats")).data,getPharmacyLowStock:async()=>(await d.get("/pharmacy/low-stock")).data},ie=()=>{var k,A,R,F,B,P,L,E,I,D,H,U;const[s,y]=x.useState(null),[l,v]=x.useState(null),[r,g]=x.useState(null),[a,j]=x.useState(null),[p,h]=x.useState(!0),{toast:u}=q();x.useEffect(()=>{b()},[]);const b=async()=>{try{h(!0);const[t,M,O,$]=await Promise.all([f.getDashboardStats(),f.getInventoryStats().catch(()=>null),f.getAssetStats().catch(()=>null),f.getFeedbackStats().catch(()=>null)]);y(t),v(M),g(O),j($)}catch{u({title:"Error",description:"Failed to load reports data",variant:"destructive"})}finally{h(!1)}},N=t=>`ETB ${(t||0).toLocaleString()}`;return p?e.jsx(V,{title:"Reports",subtitle:"Hospital Analytics & Reports",children:e.jsx("div",{className:"flex items-center justify-center py-24",children:e.jsx(Q,{className:"w-12 h-12 animate-spin text-muted-foreground"})})}):e.jsxs(V,{title:"Reports",subtitle:"Hospital Analytics & Reports Dashboard",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(i,{className:"bg-gradient-to-br from-blue-50 to-white border-blue-200",children:e.jsx(o,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Patients"}),e.jsx("p",{className:"text-3xl font-bold text-blue-700",children:(s==null?void 0:s.patients)||0})]}),e.jsx(W,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(i,{className:"bg-gradient-to-br from-green-50 to-white border-green-200",children:e.jsx(o,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Doctors"}),e.jsx("p",{className:"text-3xl font-bold text-green-700",children:(s==null?void 0:s.doctors)||0})]}),e.jsx(X,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(i,{className:"bg-gradient-to-br from-purple-50 to-white border-purple-200",children:e.jsx(o,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Appointments"}),e.jsx("p",{className:"text-3xl font-bold text-purple-700",children:(s==null?void 0:s.appointments)||0})]}),e.jsx(z,{className:"w-8 h-8 text-purple-500"})]})})}),e.jsx(i,{className:"bg-gradient-to-br from-orange-50 to-white border-orange-200",children:e.jsx(o,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bills"}),e.jsx("p",{className:"text-3xl font-bold text-orange-700",children:(s==null?void 0:s.bills)||0})]}),e.jsx(G,{className:"w-8 h-8 text-orange-500"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[l&&e.jsxs(i,{children:[e.jsx(w,{children:e.jsxs(S,{className:"text-lg flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5"})," Inventory Summary"]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-2xl font-bold",children:((k=l.totals)==null?void 0:k.total_items)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Items"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-2xl font-bold",children:N(((A=l.totals)==null?void 0:A.total_value)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Value"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-md border border-yellow-200",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:((R=l.totals)==null?void 0:R.low_stock_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Low Stock"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-md border border-red-200",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:((F=l.totals)==null?void 0:F.out_of_stock_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Out of Stock"})]})]}),l.byCategory&&l.byCategory.length>0&&e.jsxs(_,{children:[e.jsx(C,{children:e.jsxs(m,{children:[e.jsx(n,{children:"Category"}),e.jsx(n,{className:"text-right",children:"Items"}),e.jsx(n,{className:"text-right",children:"Value"})]})}),e.jsx(T,{children:l.byCategory.map(t=>e.jsxs(m,{children:[e.jsx(c,{children:t.category}),e.jsx(c,{className:"text-right",children:t.count}),e.jsx(c,{className:"text-right",children:N(t.value)})]},t.category))})]})]})]}),r&&e.jsxs(i,{children:[e.jsx(w,{children:e.jsxs(S,{className:"text-lg flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"})," Asset Summary"]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-2xl font-bold",children:((B=r.totals)==null?void 0:B.total_assets)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Assets"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-2xl font-bold",children:N(((P=r.totals)==null?void 0:P.total_current_value)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current Value"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-md border border-green-200",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:((L=r.totals)==null?void 0:L.active_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-md border border-yellow-200",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:((E=r.totals)==null?void 0:E.maintenance_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under Maintenance"})]})]}),r.byCategory&&r.byCategory.length>0&&e.jsxs(_,{children:[e.jsx(C,{children:e.jsxs(m,{children:[e.jsx(n,{children:"Category"}),e.jsx(n,{className:"text-right",children:"Count"}),e.jsx(n,{className:"text-right",children:"Value"})]})}),e.jsx(T,{children:r.byCategory.map(t=>e.jsxs(m,{children:[e.jsx(c,{children:t.category}),e.jsx(c,{className:"text-right",children:t.count}),e.jsx(c,{className:"text-right",children:N(t.value)})]},t.category))})]})]})]})]}),a&&e.jsxs(i,{children:[e.jsx(w,{children:e.jsxs(S,{className:"text-lg flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-yellow-500"})," Patient Satisfaction Report"]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-2xl font-bold",children:((I=a.overall)==null?void 0:I.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Feedback"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-md border border-yellow-200",children:[e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:["★ ",((D=a.overall)==null?void 0:D.avg_rating)||"0.0"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average Rating"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-md border border-green-200",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[((H=a.overall)==null?void 0:H.positive_percent)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Positive"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-md border border-red-200",children:[e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[((U=a.overall)==null?void 0:U.negative_percent)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Negative"})]})]}),a.byType&&a.byType.length>0&&e.jsxs(_,{children:[e.jsx(C,{children:e.jsxs(m,{children:[e.jsx(n,{children:"Feedback Type"}),e.jsx(n,{className:"text-right",children:"Count"}),e.jsx(n,{className:"text-right",children:"Avg Rating"})]})}),e.jsx(T,{children:a.byType.map(t=>e.jsxs(m,{children:[e.jsx(c,{children:t.feedback_type}),e.jsx(c,{className:"text-right",children:t.count}),e.jsx(c,{className:"text-right",children:e.jsxs("span",{className:Number(t.avg_rating)>=4?"text-green-600":Number(t.avg_rating)>=3?"text-yellow-600":"text-red-600",children:["★ ",Number(t.avg_rating).toFixed(1)]})})]},t.feedback_type))})]}),a.recent&&a.recent.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium mb-2 text-sm",children:"Recent Feedback"}),e.jsx("div",{className:"space-y-2",children:a.recent.map(t=>e.jsxs("div",{className:"flex justify-between items-start p-2 bg-muted rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:t.patient_name||"Anonymous"}),e.jsx(K,{variant:"secondary",className:"text-xs",children:t.feedback_type})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-md",children:t.comment})]}),e.jsxs("span",{className:"text-yellow-500 text-sm",children:["★".repeat(t.rating),"☆".repeat(5-t.rating)]})]},t.id))})]})]})]})]})};export{ie as default};
