import{r as h,j as e,d as K}from"./index-BM0IHp2M.js";import{c as $,S as q,A as H,a as R,B as I,D as U,e as z,f as W,g as P,T as Z}from"./AdminLayout-CWUWmsnS.js";import{B as f,C as Y,d as J}from"./card-DeprxXCB.js";import{I as d}from"./Combination-DWTH6IhY.js";import{T as Q,a as X,b as T,c as u,d as ee,e as o}from"./table-BzDp6Nnk.js";import{D as se,a as ae,b as re,c as le,d as ie}from"./dialog-DCRhT7_F.js";import{L as l}from"./label-PzrI3jAD.js";import{S as v,a as y,b,c as N,d as m}from"./select-OA5PXWO7.js";import{E as de,D as te}from"./DeleteConfirmDialog-Dqug50Ir.js";import{p as w}from"./patientService-DFGR6BTX.js";import{F as ce}from"./filter-MpqZckG0.js";import{P as ne}from"./plus-BoDGEuOf.js";import{L as oe}from"./loader-circle-aBlEtCJL.js";import{E as me}from"./eye-Dp2HsTK1.js";import{S as he}from"./square-pen-D0IrTuyB.js";import"./index-yV4U6faZ.js";const ue=["Addis Ababa","Afar","Amhara","Benishangul-Gumuz","Dire Dawa","Gambela","Harari","Oromia","Sidama","Somali","South West Ethiopia","Southern Nations","Tigray"],xe=["Addis Ketema","Akaky Kaliti","Arada","Bole","Gullele","Kirkos","Kolfe Keranio","Lemi Kura","Lideta","Nifas Silk-Lafto","Yeka"],L={name:"",age:0,gender:"Male",phone:"",address:"",email:"",blood_group:"",lastVisit:new Date().toISOString().split("T")[0],status:"Active",insurance:"",region:"",subcity:"",woreda:"",house_number:""};function je({open:S,onOpenChange:g,patient:i,onSave:C}){const[r,t]=h.useState(L);h.useEffect(()=>{t(i?{name:i.name,age:i.age,gender:i.gender,phone:i.phone,address:i.address||"",email:i.email||"",blood_group:i.blood_group||"",lastVisit:i.lastVisit,status:i.status,insurance:i.insurance||"",region:i.region||"",subcity:i.subcity||"",woreda:i.woreda||"",house_number:i.house_number||""}:L)},[i,S]);const F=s=>{s.preventDefault(),C(i?{...r,id:i.id}:r),g(!1)};return e.jsx(se,{open:S,onOpenChange:g,children:e.jsxs(ae,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsx(re,{children:e.jsx(le,{children:i?"Edit Patient":"Add New Patient"})}),e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Full Name"}),e.jsx(d,{id:"name",value:r.name,onChange:s=>t({...r,name:s.target.value}),required:!0,maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"age",children:"Age"}),e.jsx(d,{id:"age",type:"number",min:0,max:150,value:r.age,onChange:s=>t({...r,age:parseInt(s.target.value)||0}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"gender",children:"Gender"}),e.jsxs(v,{value:r.gender,onValueChange:s=>t({...r,gender:s}),children:[e.jsx(y,{children:e.jsx(b,{})}),e.jsxs(N,{children:[e.jsx(m,{value:"Male",children:"Male"}),e.jsx(m,{value:"Female",children:"Female"}),e.jsx(m,{value:"Other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone"}),e.jsx(d,{id:"phone",value:r.phone,onChange:s=>t({...r,phone:s.target.value}),required:!0,maxLength:20})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",type:"email",value:r.email,onChange:s=>t({...r,email:s.target.value}),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"blood_group",children:"Blood Group"}),e.jsxs(v,{value:r.blood_group,onValueChange:s=>t({...r,blood_group:s}),children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Select"})}),e.jsx(N,{children:["A+","A-","B+","B-","AB+","AB-","O+","O-"].map(s=>e.jsx(m,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(v,{value:r.status,onValueChange:s=>t({...r,status:s}),children:[e.jsx(y,{children:e.jsx(b,{})}),e.jsxs(N,{children:[e.jsx(m,{value:"Active",children:"Active"}),e.jsx(m,{value:"Discharged",children:"Discharged"}),e.jsx(m,{value:"Critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"lastVisit",children:"Last Visit"}),e.jsx(d,{id:"lastVisit",type:"date",value:r.lastVisit,onChange:s=>t({...r,lastVisit:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4 mt-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Insurance Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"insurance_provider",children:"Insurance Provider"}),e.jsx(d,{id:"insurance_provider",placeholder:"Company Name",value:r.insurance,onChange:s=>t({...r,insurance:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"policy_number",children:"Policy Number"}),e.jsx(d,{id:"policy_number",placeholder:"Unique Policy #"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"member_id",children:"Member ID"}),e.jsx(d,{id:"member_id",placeholder:"Member / Insurance ID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"group_number",children:"Group Number"}),e.jsx(d,{id:"group_number",placeholder:"If Corporate"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"plan_type",children:"Plan Type"}),e.jsx(d,{id:"plan_type",placeholder:"Gold, Silver, etc"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"policy_start",children:"Policy Start Date"}),e.jsx(d,{id:"policy_start",type:"date"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"policy_expiry",children:"Policy Expiry Date"}),e.jsx(d,{id:"policy_expiry",type:"date"})]})]}),e.jsx("h5",{className:"font-medium text-xs text-muted-foreground mt-2",children:"Coverage & Financials"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"coverage_percent",children:"Coverage %"}),e.jsx(d,{id:"coverage_percent",type:"number",placeholder:"80"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"deductible",children:"Deductible"}),e.jsx(d,{id:"deductible",type:"number",placeholder:"Amount"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"copay",children:"Co-pay"}),e.jsx(d,{id:"copay",type:"number",placeholder:"Amount or %"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"max_limit",children:"Max Limit"}),e.jsx(d,{id:"max_limit",type:"number",placeholder:"Total Coverage"})]})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4 mt-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Address Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"region",children:"Region"}),e.jsxs(v,{value:r.region,onValueChange:s=>t({...r,region:s,subcity:s==="Addis Ababa"?"":r.subcity}),children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Select Region"})}),e.jsx(N,{children:ue.map(s=>e.jsx(m,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"subcity",children:r.region==="Addis Ababa"?"Subcity":"Zone/Subcity"}),r.region==="Addis Ababa"?e.jsxs(v,{value:r.subcity,onValueChange:s=>t({...r,subcity:s}),children:[e.jsx(y,{children:e.jsx(b,{placeholder:"Select Subcity"})}),e.jsx(N,{children:xe.map(s=>e.jsx(m,{value:s,children:s},s))})]}):e.jsx(d,{id:"subcity",value:r.subcity,onChange:s=>t({...r,subcity:s.target.value}),placeholder:"Enter Zone or Subcity"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"woreda",children:"Woreda"}),e.jsx(d,{id:"woreda",value:r.woreda,onChange:s=>t({...r,woreda:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"house_number",children:"House Number"}),e.jsx(d,{id:"house_number",value:r.house_number,onChange:s=>t({...r,house_number:s.target.value})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-3",children:[e.jsx(l,{htmlFor:"address",children:"Full Address / Street"}),e.jsx(d,{id:"address",value:r.address||"",onChange:s=>t({...r,address:s.target.value})})]})]})]})]}),e.jsxs(ie,{children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsxs(f,{type:"submit",children:[i?"Update":"Add"," Patient"]})]})]})]})})}const B={Active:"bg-success/10 text-success border-success/20",Discharged:"bg-muted text-muted-foreground border-border",Critical:"bg-destructive/10 text-destructive border-destructive/20"},Ee=()=>{const[S,g]=h.useState([]),[i,C]=h.useState(!0),[r,t]=h.useState(""),[F,s]=h.useState(!1),[V,_]=h.useState(!1),[x,p]=h.useState(null),{toast:j}=K();h.useEffect(()=>{D()},[]);const D=async()=>{var a,c;try{C(!0);const n=await w.getAll({limit:100});g(n.data||[])}catch(n){j({title:"Error",description:((c=(a=n.response)==null?void 0:a.data)==null?void 0:c.message)||"Failed to load patients",variant:"destructive"})}finally{C(!1)}},E=S.filter(a=>{var c,n,A;return((c=a.name)==null?void 0:c.toLowerCase().includes(r.toLowerCase()))||((n=a.patient_id)==null?void 0:n.toLowerCase().includes(r.toLowerCase()))||((A=a.phone)==null?void 0:A.includes(r))}),O=async a=>{var c,n;try{a.id?(await w.update(a.id,a),j({title:"Patient Updated",description:`${a.name} has been updated.`})):(await w.create(a),j({title:"Patient Added",description:`${a.name} has been added.`})),D(),p(null),s(!1)}catch(A){j({title:"Error",description:((n=(c=A.response)==null?void 0:c.data)==null?void 0:n.message)||"Failed to save patient",variant:"destructive"})}},k=async()=>{var a,c;if(x)try{await w.delete(x.id),j({title:"Patient Deleted",description:`${x.name} has been removed.`,variant:"destructive"}),D(),p(null)}catch(n){j({title:"Error",description:((c=(a=n.response)==null?void 0:a.data)==null?void 0:c.message)||"Failed to delete patient",variant:"destructive"})}_(!1)},M=a=>{p(a),s(!0)},G=a=>{p(a),_(!0)};return e.jsxs($,{title:"Patients",subtitle:"Manage patient records and information",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(d,{placeholder:"Search patients...",className:"pl-10",value:r,onChange:a=>t(a.target.value)})]}),e.jsx(f,{variant:"outline",size:"icon",children:e.jsx(ce,{className:"w-4 h-4"})})]}),e.jsxs(f,{className:"gap-2",onClick:()=>{p(null),s(!0)},children:[e.jsx(ne,{className:"w-4 h-4"}),"Add Patient"]})]}),e.jsx(Y,{children:e.jsx(J,{className:"p-0",children:i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(oe,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(Q,{children:[e.jsx(X,{children:e.jsxs(T,{children:[e.jsx(u,{children:"Patient ID"}),e.jsx(u,{children:"Patient"}),e.jsx(u,{children:"Age/Gender"}),e.jsx(u,{children:"Phone"}),e.jsx(u,{children:"Blood Group"}),e.jsx(u,{children:"Address"}),e.jsx(u,{children:"Status"}),e.jsx(u,{className:"text-right",children:"Actions"})]})}),e.jsxs(ee,{children:[E.map(a=>{var c;return e.jsxs(T,{className:"group",children:[e.jsx(o,{className:"font-mono text-sm",children:a.patient_id}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"h-9 w-9",children:e.jsx(R,{className:"bg-primary/10 text-primary text-sm",children:(c=a.name)==null?void 0:c.split(" ").map(n=>n[0]).join("").substring(0,2)})}),e.jsx("span",{className:"font-medium",children:a.name})]})}),e.jsxs(o,{children:[a.age,"y / ",a.gender]}),e.jsx(o,{className:"text-muted-foreground",children:a.phone}),e.jsx(o,{children:e.jsx(I,{variant:"secondary",children:a.blood_group||"N/A"})}),e.jsxs(o,{className:"text-muted-foreground max-w-[200px] truncate",children:[a.address||"N/A",(a.region||a.subcity)&&e.jsxs("div",{className:"text-xs text-muted-foreground/70",children:[a.region," ",a.subcity?`- ${a.subcity}`:""]})]}),e.jsx(o,{children:e.jsx(I,{variant:"outline",className:B[a.status]||B.Active,children:a.status})}),e.jsx(o,{className:"text-right",children:e.jsxs(U,{children:[e.jsx(z,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:e.jsx(de,{className:"w-4 h-4"})})}),e.jsxs(W,{align:"end",children:[e.jsxs(P,{className:"gap-2",onClick:()=>window.location.href=`/patients/${a.id}`,children:[e.jsx(me,{className:"w-4 h-4"})," View Details"]}),e.jsxs(P,{className:"gap-2",onClick:()=>M(a),children:[e.jsx(he,{className:"w-4 h-4"})," Edit"]}),e.jsxs(P,{className:"gap-2 text-destructive",onClick:()=>G(a),children:[e.jsx(Z,{className:"w-4 h-4"})," Delete"]})]})]})})]},a.id)}),E.length===0&&!i&&e.jsx(T,{children:e.jsx(o,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No patients found"})})]})]})})}),e.jsx(je,{open:F,onOpenChange:s,patient:x,onSave:O}),e.jsx(te,{open:V,onOpenChange:_,title:"Delete Patient",description:`Are you sure you want to delete ${x==null?void 0:x.name}? This action cannot be undone.`,onConfirm:k})]})};export{Ee as default};
