import{r,d as G,j as e}from"./index-DZAlsvLE.js";import{c as K,e as Q,A as W,a as Y,B as C,D as Z,f as ee,g as ae,h as w}from"./AdminLayout-D12jS9pN.js";import{I as c,B as u,C as se,d as te}from"./card-DfuB3kKO.js";import{L as i}from"./label-B7mPZteH.js";import{T as le,a as ne,b as D,c as m,d as re,e as o}from"./table-DSRtfemy.js";import{E as ie,i as ce,T as oe,D as de,a as he,b as me,c as xe,k as ue,S as T,d as b,e as E,f as F,g as A,h as fe,j as pe}from"./DeleteConfirmDialog-DI90Viws.js";import{s as y}from"./staffService-B2PpuklV.js";import{F as je}from"./filter-Dy4-oP81.js";import{P as ge}from"./plus-j_V7wq7w.js";import{L as X}from"./loader-circle-ONSjYwRk.js";import{E as ye}from"./eye-lejhtZAQ.js";import"./index-BF5NQnWb.js";const ve={Morning:"bg-warning/10 text-warning border-warning/20",Afternoon:"bg-info/10 text-info border-info/20",Night:"bg-purple-500/10 text-purple-500 border-purple-500/20",Rotating:"bg-muted text-muted-foreground border-border"},Se=["Nurse","Receptionist","Pharmacist","Lab Technician","Radiologist","Accountant","Cleaner","Security","Admin"],Ne=["Morning","Afternoon","Night","Rotating"],Ce=["Active","Inactive","On Leave"],Re=()=>{const[k,B]=r.useState([]),[_,L]=r.useState(!0),[f,P]=r.useState(""),[V,x]=r.useState(!1),[H,v]=r.useState(!1),[d,p]=r.useState(null),[j,M]=r.useState(!1),[S,g]=r.useState(!1),{toast:h}=G(),[s,n]=r.useState({name:"",role:"",phone:"",email:"",shift:"Morning",status:"Active",join_date:new Date().toISOString().split("T")[0],salary:"",address:"",emergency_contact:""});r.useEffect(()=>{N()},[]);const N=async()=>{var a,l;try{L(!0);const t=await y.getAll({limit:100});B(t.data||[])}catch(t){h({title:"Error",description:((l=(a=t.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to load staff",variant:"destructive"})}finally{L(!1)}},O=()=>{n({name:"",role:"",phone:"",email:"",shift:"Morning",status:"Active",join_date:new Date().toISOString().split("T")[0],salary:"",address:"",emergency_contact:""}),p(null),M(!1)},q=()=>{O(),x(!0)},z=a=>{var l,t;p(a),M(!0),n({name:a.name||"",role:a.role||"",phone:a.phone||"",email:a.email||"",shift:a.shift||"Morning",status:a.status||"Active",join_date:((l=a.join_date)==null?void 0:l.split("T")[0])||new Date().toISOString().split("T")[0],salary:((t=a.salary)==null?void 0:t.toString())||"",address:a.address||"",emergency_contact:a.emergency_contact||""}),x(!0)},U=a=>{p(a),v(!0)},J=async()=>{var a,l;if(!s.name||!s.role||!s.phone||!s.email){h({title:"Error",description:"Please fill all required fields",variant:"destructive"});return}try{g(!0);const t={...s,salary:s.salary?parseFloat(s.salary):null};j&&d?(await y.update(d.id,t),h({title:"Success",description:"Staff member updated successfully"})):(await y.create(t),h({title:"Success",description:"Staff member added successfully"})),x(!1),O(),N()}catch(t){h({title:"Error",description:((l=(a=t.response)==null?void 0:a.data)==null?void 0:l.message)||"Operation failed",variant:"destructive"})}finally{g(!1)}},$=async()=>{var a,l;if(d)try{g(!0),await y.delete(d.id),h({title:"Success",description:"Staff member deleted successfully"}),v(!1),p(null),N()}catch(t){h({title:"Error",description:((l=(a=t.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to delete staff member",variant:"destructive"})}finally{g(!1)}},I=k.filter(a=>{var l,t,R;return((l=a.name)==null?void 0:l.toLowerCase().includes(f.toLowerCase()))||((t=a.role)==null?void 0:t.toLowerCase().includes(f.toLowerCase()))||((R=a.staff_id)==null?void 0:R.toLowerCase().includes(f.toLowerCase()))});return e.jsxs(K,{title:"Staff",subtitle:"Manage hospital staff and employees",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search staff...",className:"pl-10",value:f,onChange:a=>P(a.target.value)})]}),e.jsx(u,{variant:"outline",size:"icon",children:e.jsx(je,{className:"w-4 h-4"})})]}),e.jsxs(u,{className:"gap-2",onClick:q,children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Staff"]})]}),e.jsx(se,{children:e.jsx(te,{className:"p-0",children:_?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(le,{children:[e.jsx(ne,{children:e.jsxs(D,{children:[e.jsx(m,{children:"Staff ID"}),e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Role"}),e.jsx(m,{children:"Contact"}),e.jsx(m,{children:"Shift"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsxs(re,{children:[I.map(a=>{var l;return e.jsxs(D,{className:"group",children:[e.jsx(o,{className:"font-mono text-sm",children:a.staff_id}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"h-9 w-9",children:e.jsx(Y,{className:"bg-primary/10 text-primary text-sm",children:(l=a.name)==null?void 0:l.split(" ").map(t=>t[0]).join("").substring(0,2)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.email})]})]})}),e.jsx(o,{children:e.jsx(C,{variant:"secondary",children:a.role})}),e.jsx(o,{className:"text-muted-foreground",children:a.phone}),e.jsx(o,{children:e.jsx(C,{variant:"outline",className:ve[a.shift]||"",children:a.shift})}),e.jsx(o,{children:e.jsx(C,{variant:"outline",className:a.status==="Active"?"border-success text-success":"border-muted",children:a.status})}),e.jsx(o,{className:"text-right",children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:e.jsx(ie,{className:"w-4 h-4"})})}),e.jsxs(ae,{align:"end",children:[e.jsxs(w,{className:"gap-2",children:[e.jsx(ye,{className:"w-4 h-4"})," View"]}),e.jsxs(w,{className:"gap-2",onClick:()=>z(a),children:[e.jsx(ce,{className:"w-4 h-4"})," Edit"]}),e.jsxs(w,{className:"gap-2 text-destructive",onClick:()=>U(a),children:[e.jsx(oe,{className:"w-4 h-4"})," Delete"]})]})]})})]},a.id)}),I.length===0&&!_&&e.jsx(D,{children:e.jsx(o,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No staff found"})})]})]})})}),e.jsx(de,{open:V,onOpenChange:x,children:e.jsxs(he,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(me,{children:[e.jsx(xe,{children:j?"Edit Staff Member":"Add New Staff Member"}),e.jsx(ue,{children:j?"Update staff member information":"Fill in the details to add a new staff member"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",children:"Full Name *"}),e.jsx(c,{id:"name",value:s.name,onChange:a=>n({...s,name:a.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"role",children:"Role *"}),e.jsxs(T,{value:s.role,onValueChange:a=>n({...s,role:a}),children:[e.jsx(b,{children:e.jsx(E,{placeholder:"Select role"})}),e.jsx(F,{children:Se.map(a=>e.jsx(A,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"phone",children:"Phone *"}),e.jsx(c,{id:"phone",value:s.phone,onChange:a=>n({...s,phone:a.target.value}),placeholder:"+251 9XX XXX XXX"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"email",children:"Email *"}),e.jsx(c,{id:"email",type:"email",value:s.email,onChange:a=>n({...s,email:a.target.value}),placeholder:"email@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"shift",children:"Shift"}),e.jsxs(T,{value:s.shift,onValueChange:a=>n({...s,shift:a}),children:[e.jsx(b,{children:e.jsx(E,{placeholder:"Select shift"})}),e.jsx(F,{children:Ne.map(a=>e.jsx(A,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"status",children:"Status"}),e.jsxs(T,{value:s.status,onValueChange:a=>n({...s,status:a}),children:[e.jsx(b,{children:e.jsx(E,{placeholder:"Select status"})}),e.jsx(F,{children:Ce.map(a=>e.jsx(A,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"join_date",children:"Join Date"}),e.jsx(c,{id:"join_date",type:"date",value:s.join_date,onChange:a=>n({...s,join_date:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"salary",children:"Salary (ETB)"}),e.jsx(c,{id:"salary",type:"number",value:s.salary,onChange:a=>n({...s,salary:a.target.value}),placeholder:"Monthly salary"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(i,{htmlFor:"address",children:"Address"}),e.jsx(c,{id:"address",value:s.address,onChange:a=>n({...s,address:a.target.value}),placeholder:"Home address"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(i,{htmlFor:"emergency_contact",children:"Emergency Contact"}),e.jsx(c,{id:"emergency_contact",value:s.emergency_contact,onChange:a=>n({...s,emergency_contact:a.target.value}),placeholder:"Emergency contact name and phone"})]})]}),e.jsxs(fe,{children:[e.jsx(u,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsxs(u,{onClick:J,disabled:S,children:[S&&e.jsx(X,{className:"w-4 h-4 mr-2 animate-spin"}),j?"Update":"Add"," Staff"]})]})]})}),e.jsx(pe,{open:H,onOpenChange:v,onConfirm:$,title:"Delete Staff Member",description:`Are you sure you want to delete ${d==null?void 0:d.name}? This action cannot be undone.`,loading:S})]})};export{Re as default};
