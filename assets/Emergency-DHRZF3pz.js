import{i as g,r as l,d as ee,j as e}from"./index-C7Usvyjo.js";import{c as se,T as M,U as te,S as ae,B as P,D as re,e as ne,f as ie,g as O}from"./AdminLayout-KJdpyVPw.js";import{C as p,d as j,B as N}from"./card-D4lL5XKr.js";import{I as w}from"./input-BWiyuCbu.js";import{L as c}from"./label-BR1iVthZ.js";import{T as $}from"./textarea-dwx7HkWb.js";import{T as le,a as ce,b as R,c as h,d as oe,e as o}from"./table-4bgxXXk3.js";import{E as de,S as me,T as ge,D as he,a as xe,b as ue,c as pe,f as je,d as fe,e as ve}from"./DeleteConfirmDialog-DieDgxFE.js";import{S as C,a as _,b as S,c as D,d as T}from"./select-C3KF1_PI.js";import{A as ye}from"./ambulance-rrh7oQuS.js";import{P as be}from"./plus-BMYysXAs.js";import{L as z}from"./loader-circle-CE1kBXf-.js";import{E as Ne}from"./eye-BhGGlvcf.js";import"./index-DXYLpZ2l.js";const E={async getAll(a={}){return(await g.get("/emergency",{params:a})).data},async getById(a){return(await g.get(`/emergency/${a}`)).data.data},async create(a){return(await g.post("/emergency",a)).data.data},async update(a,x){return(await g.put(`/emergency/${a}`,x)).data.data},async getActive(){return(await g.get("/emergency/active")).data.data},async getStats(){return(await g.get("/emergency/stats")).data.data},async delete(a){await g.delete(`/emergency/${a}`)}},we={Resuscitation:"bg-black text-white",Critical:"bg-destructive/10 text-destructive border-destructive/20",Urgent:"bg-warning/10 text-warning border-warning/20","Less Urgent":"bg-info/10 text-info border-info/20","Non-Urgent":"bg-success/10 text-success border-success/20"},Ce={Waiting:"bg-muted text-muted-foreground border-border","Under Treatment":"bg-warning/10 text-warning border-warning/20",Stabilized:"bg-info/10 text-info border-info/20",Discharged:"bg-success/10 text-success border-success/20",Transferred:"bg-purple-500/10 text-purple-500 border-purple-500/20",Deceased:"bg-destructive/10 text-destructive border-destructive/20"},_e=["Resuscitation","Critical","Urgent","Less Urgent","Non-Urgent"],Se=["Black","Red","Orange","Yellow","Green"],De=["Waiting","Under Treatment","Stabilized","Discharged","Transferred","Deceased"],Te=["Male","Female"],$e=()=>{const[a,x]=l.useState([]),[U,k]=l.useState(!0),[f,H]=l.useState(""),[G,u]=l.useState(!1),[q,L]=l.useState(!1),[d,v]=l.useState(null),[y,B]=l.useState(!1),[F,b]=l.useState(!1),{toast:m}=ee(),[t,i]=l.useState({patient_name:"",age:"",gender:"",chief_complaint:"",triage_level:"Urgent",triage_color:"Orange",status:"Waiting",bed_number:"",notes:""});l.useEffect(()=>{A()},[]);const A=async()=>{var s,r;try{k(!0);const n=await E.getAll({limit:100});x(n.data||[])}catch(n){m({title:"Error",description:((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to load emergency cases",variant:"destructive"})}finally{k(!1)}},I=()=>{i({patient_name:"",age:"",gender:"",chief_complaint:"",triage_level:"Urgent",triage_color:"Orange",status:"Waiting",bed_number:"",notes:""}),v(null),B(!1)},Y=()=>{I(),u(!0)},J=s=>{var r;v(s),B(!0),i({patient_name:s.patient_name||"",age:((r=s.age)==null?void 0:r.toString())||"",gender:s.gender||"",chief_complaint:s.chief_complaint||"",triage_level:s.triage_level||"Urgent",triage_color:s.triage_color||"Orange",status:s.status||"Waiting",bed_number:s.bed_number||"",notes:s.notes||""}),u(!0)},K=s=>{v(s),L(!0)},Q=async()=>{var s,r;if(!t.patient_name||!t.chief_complaint){m({title:"Error",description:"Please fill patient name and chief complaint",variant:"destructive"});return}try{b(!0);const n={...t,age:t.age?parseInt(t.age):null};y&&d?(await E.update(d.id,n),m({title:"Success",description:"Emergency case updated successfully"})):(await E.create(n),m({title:"Success",description:"Emergency case registered successfully"})),u(!1),I(),A()}catch(n){m({title:"Error",description:((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.message)||"Operation failed",variant:"destructive"})}finally{b(!1)}},X=async()=>{var s,r;if(d)try{b(!0),await E.delete(d.id),m({title:"Success",description:"Emergency case deleted successfully"}),L(!1),v(null),A()}catch(n){m({title:"Error",description:((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to delete case",variant:"destructive"})}finally{b(!1)}},W=a.filter(s=>{var r,n,V;return((r=s.patient_name)==null?void 0:r.toLowerCase().includes(f.toLowerCase()))||((n=s.case_id)==null?void 0:n.toLowerCase().includes(f.toLowerCase()))||((V=s.chief_complaint)==null?void 0:V.toLowerCase().includes(f.toLowerCase()))}),Z=s=>s?new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"N/A";return e.jsxs(se,{title:"Emergency Department",subtitle:"Manage emergency cases and triage",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(p,{className:"border-destructive/50",children:e.jsx(j,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Cases"}),e.jsx("p",{className:"text-3xl font-bold text-destructive",children:a.filter(s=>s.status==="Waiting"||s.status==="Under Treatment").length})]}),e.jsx(M,{className:"w-8 h-8 text-destructive"})]})})}),e.jsx(p,{children:e.jsx(j,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Critical"}),e.jsx("p",{className:"text-3xl font-bold text-warning",children:a.filter(s=>s.triage_level==="Critical"||s.triage_level==="Resuscitation").length})]}),e.jsx(M,{className:"w-8 h-8 text-warning"})]})})}),e.jsx(p,{children:e.jsx(j,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Waiting"}),e.jsx("p",{className:"text-3xl font-bold",children:a.filter(s=>s.status==="Waiting").length})]}),e.jsx(te,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(p,{children:e.jsx(j,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Today's Cases"}),e.jsx("p",{className:"text-3xl font-bold",children:a.length})]}),e.jsx(ye,{className:"w-8 h-8 text-muted-foreground"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(w,{placeholder:"Search emergency cases...",className:"pl-10",value:f,onChange:s=>H(s.target.value)})]}),e.jsxs(N,{className:"gap-2",onClick:Y,children:[e.jsx(be,{className:"w-4 h-4"}),"New Emergency"]})]}),e.jsx(p,{children:e.jsx(j,{className:"p-0",children:U?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(R,{children:[e.jsx(h,{children:"Case ID"}),e.jsx(h,{children:"Patient"}),e.jsx(h,{children:"Chief Complaint"}),e.jsx(h,{children:"Triage"}),e.jsx(h,{children:"Arrival"}),e.jsx(h,{children:"Status"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsxs(oe,{children:[W.map(s=>e.jsxs(R,{className:"group",children:[e.jsx(o,{className:"font-mono text-sm",children:s.case_id}),e.jsx(o,{className:"font-medium",children:s.patient_name||"Unknown"}),e.jsx(o,{className:"max-w-[200px] truncate",children:s.chief_complaint}),e.jsx(o,{children:e.jsx(P,{variant:"outline",className:we[s.triage_level]||"",children:s.triage_level})}),e.jsx(o,{children:Z(s.arrival_time||s.created_at)}),e.jsx(o,{children:e.jsx(P,{variant:"outline",className:Ce[s.status]||"",children:s.status})}),e.jsx(o,{className:"text-right",children:e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:e.jsx(de,{className:"w-4 h-4"})})}),e.jsxs(ie,{align:"end",children:[e.jsxs(O,{className:"gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"})," View Details"]}),e.jsxs(O,{className:"gap-2",onClick:()=>J(s),children:[e.jsx(me,{className:"w-4 h-4"})," Update"]}),e.jsxs(O,{className:"gap-2 text-destructive",onClick:()=>K(s),children:[e.jsx(ge,{className:"w-4 h-4"})," Delete"]})]})]})})]},s.id)),W.length===0&&!U&&e.jsx(R,{children:e.jsx(o,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No emergency cases found"})})]})]})})}),e.jsx(he,{open:G,onOpenChange:u,children:e.jsxs(xe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ue,{children:[e.jsx(pe,{children:y?"Update Emergency Case":"Register New Emergency"}),e.jsx(je,{children:y?"Update patient status and information":"Fill in emergency patient details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"patient_name",children:"Patient Name *"}),e.jsx(w,{id:"patient_name",value:t.patient_name,onChange:s=>i({...t,patient_name:s.target.value}),placeholder:"Enter patient name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"age",children:"Age"}),e.jsx(w,{id:"age",type:"number",value:t.age,onChange:s=>i({...t,age:s.target.value}),placeholder:"Age"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"gender",children:"Gender"}),e.jsxs(C,{value:t.gender,onValueChange:s=>i({...t,gender:s}),children:[e.jsx(_,{children:e.jsx(S,{placeholder:"Select"})}),e.jsx(D,{children:Te.map(s=>e.jsx(T,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(c,{htmlFor:"chief_complaint",children:"Chief Complaint *"}),e.jsx($,{id:"chief_complaint",value:t.chief_complaint,onChange:s=>i({...t,chief_complaint:s.target.value}),placeholder:"Describe the main complaint or reason for visit",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"triage_level",children:"Triage Level"}),e.jsxs(C,{value:t.triage_level,onValueChange:s=>i({...t,triage_level:s}),children:[e.jsx(_,{children:e.jsx(S,{placeholder:"Select triage"})}),e.jsx(D,{children:_e.map(s=>e.jsx(T,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"triage_color",children:"Triage Color"}),e.jsxs(C,{value:t.triage_color,onValueChange:s=>i({...t,triage_color:s}),children:[e.jsx(_,{children:e.jsx(S,{placeholder:"Select color"})}),e.jsx(D,{children:Se.map(s=>e.jsx(T,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs(C,{value:t.status,onValueChange:s=>i({...t,status:s}),children:[e.jsx(_,{children:e.jsx(S,{placeholder:"Select status"})}),e.jsx(D,{children:De.map(s=>e.jsx(T,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"bed_number",children:"Bed Number"}),e.jsx(w,{id:"bed_number",value:t.bed_number,onChange:s=>i({...t,bed_number:s.target.value}),placeholder:"E.g., ER-01"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:"Notes"}),e.jsx($,{id:"notes",value:t.notes,onChange:s=>i({...t,notes:s.target.value}),placeholder:"Additional notes",rows:2})]})]}),e.jsxs(fe,{children:[e.jsx(N,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsxs(N,{onClick:Q,disabled:F,children:[F&&e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),y?"Update":"Register"]})]})]})}),e.jsx(ve,{open:q,onOpenChange:L,onConfirm:X,title:"Delete Emergency Case",description:`Are you sure you want to delete the emergency case for ${d==null?void 0:d.patient_name}?`,loading:F})]})};export{$e as default};
