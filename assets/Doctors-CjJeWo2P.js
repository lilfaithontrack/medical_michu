import{r as c,j as e,d as q}from"./index-Ds3XC1ar.js";import{c as V,S as $,A as R,a as H,B as A,D as _,e as G,f as U,g as C}from"./AdminLayout-CXoTaXAo.js";import{B as v,C as J,d as K}from"./card-f0OTF_cP.js";import{I as u}from"./Combination-DFmHiCFn.js";import{T as Q,a as W,b as F,c as m,d as X,e as o}from"./table-DBI9rBV5.js";import{D as Y,a as Z,b as ee,c as se,d as ae,E as te,S as ie,T as re,e as le}from"./DeleteConfirmDialog-B8W9ttXa.js";import{L as h}from"./label-BYM7NRxj.js";import{S as E,a as T,b as z,c as B,d as g}from"./select-ksrcy_E6.js";import{d as b}from"./doctorService-XNbiPam0.js";import{F as ne}from"./filter-DtbnHYL4.js";import{P as ce}from"./plus-WvUahM_s.js";import{L as oe}from"./loader-circle-Duh_MnJ-.js";import{E as de}from"./eye-BBnAzWI7.js";import"./index-B2wLCXzD.js";const me=["Cardiology","Neurology","Pediatrics","Orthopedics","Dermatology","Psychiatry","Oncology","General Medicine"],I={name:"",specialization:"General Medicine",phone:"",email:"",status:"Available",patients:0,experience:"1 year"};function he({open:f,onOpenChange:p,doctor:i,onSave:y}){const[t,n]=c.useState(I);c.useEffect(()=>{n(i?{name:i.name,specialization:i.specialization,phone:i.phone,email:i.email,status:i.status,patients:i.patients,experience:i.experience}:I)},[i,f]);const w=a=>{a.preventDefault(),y(i?{...t,id:i.id}:t),p(!1)};return e.jsx(Y,{open:f,onOpenChange:p,children:e.jsxs(Z,{className:"sm:max-w-[500px]",children:[e.jsx(ee,{children:e.jsx(se,{children:i?"Edit Doctor":"Add New Doctor"})}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"name",children:"Full Name"}),e.jsx(u,{id:"name",value:t.name,onChange:a=>n({...t,name:a.target.value}),placeholder:"Dr. John Smith",required:!0,maxLength:100})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"specialization",children:"Specialization"}),e.jsxs(E,{value:t.specialization,onValueChange:a=>n({...t,specialization:a}),children:[e.jsx(T,{children:e.jsx(z,{})}),e.jsx(B,{children:me.map(a=>e.jsx(g,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"experience",children:"Experience"}),e.jsx(u,{id:"experience",value:t.experience,onChange:a=>n({...t,experience:a.target.value}),placeholder:"5 years",required:!0,maxLength:20})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"phone",children:"Phone"}),e.jsx(u,{id:"phone",value:t.phone,onChange:a=>n({...t,phone:a.target.value}),required:!0,maxLength:20})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email",children:"Email"}),e.jsx(u,{id:"email",type:"email",value:t.email,onChange:a=>n({...t,email:a.target.value}),required:!0,maxLength:100})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"status",children:"Status"}),e.jsxs(E,{value:t.status,onValueChange:a=>n({...t,status:a}),children:[e.jsx(T,{children:e.jsx(z,{})}),e.jsxs(B,{children:[e.jsx(g,{value:"Available",children:"Available"}),e.jsx(g,{value:"In Surgery",children:"In Surgery"}),e.jsx(g,{value:"On Leave",children:"On Leave"}),e.jsx(g,{value:"Busy",children:"Busy"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"patients",children:"Assigned Patients"}),e.jsx(u,{id:"patients",type:"number",min:0,value:t.patients,onChange:a=>n({...t,patients:parseInt(a.target.value)||0})})]})]})]}),e.jsxs(ae,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsxs(v,{type:"submit",children:[i?"Update":"Add"," Doctor"]})]})]})]})})}const O={Available:"bg-success/10 text-success border-success/20","In Surgery":"bg-warning/10 text-warning border-warning/20","On Leave":"bg-muted text-muted-foreground border-border",Busy:"bg-destructive/10 text-destructive border-destructive/20"},Fe=()=>{const[f,p]=c.useState([]),[i,y]=c.useState(!0),[t,n]=c.useState(""),[w,a]=c.useState(!1),[P,S]=c.useState(!1),[d,j]=c.useState(null),{toast:x}=q();c.useEffect(()=>{D()},[]);const D=async()=>{var s,r;try{y(!0);const l=await b.getAll({limit:100});p(l.data||[])}catch(l){x({title:"Error",description:((r=(s=l.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to load doctors",variant:"destructive"})}finally{y(!1)}},L=f.filter(s=>{var r,l,N;return((r=s.name)==null?void 0:r.toLowerCase().includes(t.toLowerCase()))||((l=s.specialization)==null?void 0:l.toLowerCase().includes(t.toLowerCase()))||((N=s.doctor_id)==null?void 0:N.toLowerCase().includes(t.toLowerCase()))}),M=async s=>{var r,l;try{s.id?(await b.update(s.id,s),x({title:"Doctor Updated",description:`${s.name} has been updated.`})):(await b.create(s),x({title:"Doctor Added",description:`${s.name} has been added.`})),D(),j(null),a(!1)}catch(N){x({title:"Error",description:((l=(r=N.response)==null?void 0:r.data)==null?void 0:l.message)||"Failed to save doctor",variant:"destructive"})}},k=async()=>{var s,r;if(d)try{await b.delete(d.id),x({title:"Doctor Removed",description:`${d.name} has been removed.`,variant:"destructive"}),D(),j(null)}catch(l){x({title:"Error",description:((r=(s=l.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to delete doctor",variant:"destructive"})}S(!1)};return e.jsxs(V,{title:"Doctors",subtitle:"Manage doctor profiles and schedules",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(u,{placeholder:"Search doctors...",className:"pl-10",value:t,onChange:s=>n(s.target.value)})]}),e.jsx(v,{variant:"outline",size:"icon",children:e.jsx(ne,{className:"w-4 h-4"})})]}),e.jsxs(v,{className:"gap-2",onClick:()=>{j(null),a(!0)},children:[e.jsx(ce,{className:"w-4 h-4"}),"Add Doctor"]})]}),e.jsx(J,{children:e.jsx(K,{className:"p-0",children:i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(oe,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(F,{children:[e.jsx(m,{children:"Doctor ID"}),e.jsx(m,{children:"Doctor"}),e.jsx(m,{children:"Specialization"}),e.jsx(m,{children:"Contact"}),e.jsx(m,{children:"Fee"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsxs(X,{children:[L.map(s=>{var r;return e.jsxs(F,{className:"group",children:[e.jsx(o,{className:"font-mono text-sm",children:s.doctor_id}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-9 w-9",children:e.jsx(H,{className:"bg-primary/10 text-primary text-sm",children:(r=s.name)==null?void 0:r.replace("Dr. ","").split(" ").map(l=>l[0]).join("").substring(0,2)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]})]})}),e.jsx(o,{children:e.jsx(A,{variant:"secondary",children:s.specialization})}),e.jsx(o,{className:"text-muted-foreground",children:s.phone}),e.jsxs(o,{children:["ETB ",s.consultation_fee||0]}),e.jsx(o,{children:e.jsx(A,{variant:"outline",className:O[s.status]||O.Available,children:s.status})}),e.jsx(o,{className:"text-right",children:e.jsxs(_,{children:[e.jsx(G,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:e.jsx(te,{className:"w-4 h-4"})})}),e.jsxs(U,{align:"end",children:[e.jsxs(C,{className:"gap-2",onClick:()=>window.location.href=`/doctors/${s.id}`,children:[e.jsx(de,{className:"w-4 h-4"})," View Profile"]}),e.jsxs(C,{className:"gap-2",onClick:()=>{j(s),a(!0)},children:[e.jsx(ie,{className:"w-4 h-4"})," Edit"]}),e.jsxs(C,{className:"gap-2 text-destructive",onClick:()=>{j(s),S(!0)},children:[e.jsx(re,{className:"w-4 h-4"})," Delete"]})]})]})})]},s.id)}),L.length===0&&!i&&e.jsx(F,{children:e.jsx(o,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No doctors found"})})]})]})})}),e.jsx(he,{open:w,onOpenChange:a,doctor:d,onSave:M}),e.jsx(le,{open:P,onOpenChange:S,title:"Remove Doctor",description:`Are you sure you want to remove ${d==null?void 0:d.name}?`,onConfirm:k})]})};export{Fe as default};
