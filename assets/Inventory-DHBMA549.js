import{c as Z,f as x,r,d as me,j as e}from"./index-BM0IHp2M.js";import{c as je,i as pe,B as _,S as ve,T as ge}from"./AdminLayout-CWUWmsnS.js";import{C as f,d as w,a as ye,b as _e,B as j}from"./card-DeprxXCB.js";import{I as c}from"./Combination-DWTH6IhY.js";import{L as n}from"./label-PzrI3jAD.js";import{T as D}from"./textarea-DWoGW9ma.js";import{D as Q,a as K,b as W,c as J,d as X}from"./dialog-DCRhT7_F.js";import{S as E,a as R,b as A,c as B,d as p}from"./select-OA5PXWO7.js";import{T as fe,a as we,b as F,c as v,d as ke,e as u}from"./table-BzDp6Nnk.js";import{B as O}from"./boxes-DdsXFpGC.js";import{P as Ne}from"./plus-BoDGEuOf.js";import{L as Se}from"./loader-circle-aBlEtCJL.js";import{S as Ce}from"./square-pen-D0IrTuyB.js";import"./index-yV4U6faZ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=Z("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=Z("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),g={getAll:async a=>(await x.get("/inventory",{params:a})).data,getById:async a=>(await x.get(`/inventory/${a}`)).data,create:async a=>(await x.post("/inventory",a)).data,update:async(a,i)=>(await x.put(`/inventory/${a}`,i)).data,delete:async a=>(await x.delete(`/inventory/${a}`)).data,addTransaction:async(a,i)=>(await x.post(`/inventory/${a}/transaction`,i)).data,getTransactions:async(a,i)=>(await x.get(`/inventory/${a}/transactions`,{params:i})).data,getLowStock:async()=>(await x.get("/inventory/low-stock")).data,getStats:async()=>(await x.get("/inventory/stats")).data},Y=["Medical Supplies","Cleaning","Office","Kitchen","Linen","PPE","Laboratory","Surgical","General"],$e=()=>{var $,G,H,z;const[a,i]=r.useState([]),[h,ee]=r.useState([]),[o,se]=r.useState(null),[te,P]=r.useState(!0),[ae,k]=r.useState(!1),[ne,T]=r.useState(!1),[I,U]=r.useState(null),[N,le]=r.useState(null),[q,re]=r.useState(""),[S,oe]=r.useState(""),[t,l]=r.useState({name:"",category:"General",description:"",unit_of_measure:"Piece",stock_quantity:"",min_stock_level:"10",max_stock_level:"1000",reorder_level:"20",unit_cost:"",supplier:"",location:"",notes:""}),[d,C]=r.useState({transaction_type:"Received",quantity:"",department:"",notes:""}),{toast:m}=me();r.useEffect(()=>{L()},[S]);const L=async()=>{try{P(!0);const s={limit:100};S&&S!=="all"&&(s.category=S);const[b,y,he]=await Promise.all([g.getAll(s),g.getStats(),g.getLowStock().catch(()=>[])]);i(b.data||[]),se(y),ee(he||[])}catch{m({title:"Error",description:"Failed to load inventory",variant:"destructive"})}finally{P(!1)}},ce=()=>{U(null),l({name:"",category:"General",description:"",unit_of_measure:"Piece",stock_quantity:"",min_stock_level:"10",max_stock_level:"1000",reorder_level:"20",unit_cost:"",supplier:"",location:"",notes:""}),k(!0)},ie=s=>{U(s),l({name:s.name,category:s.category,description:s.description||"",unit_of_measure:s.unit_of_measure,stock_quantity:String(s.stock_quantity),min_stock_level:String(s.min_stock_level),max_stock_level:String(s.max_stock_level||1e3),reorder_level:String(s.reorder_level||20),unit_cost:String(s.unit_cost),supplier:s.supplier||"",location:s.location||"",notes:s.notes||""}),k(!0)},de=async()=>{var s,b;try{const y={...t,stock_quantity:parseInt(t.stock_quantity)||0,min_stock_level:parseInt(t.min_stock_level)||10,max_stock_level:parseInt(t.max_stock_level)||1e3,reorder_level:parseInt(t.reorder_level)||20,unit_cost:parseFloat(t.unit_cost)||0};I?(await g.update(I.id,y),m({title:"Success",description:"Item updated"})):(await g.create(y),m({title:"Success",description:"Item created"})),k(!1),L()}catch(y){m({title:"Error",description:((b=(s=y.response)==null?void 0:s.data)==null?void 0:b.message)||"Failed to save",variant:"destructive"})}},xe=async()=>{if(N)try{await g.addTransaction(N.id,{...d,quantity:parseInt(d.quantity)||0}),m({title:"Success",description:"Transaction recorded"}),T(!1),L()}catch{m({title:"Error",description:"Failed to record transaction",variant:"destructive"})}},ue=async s=>{try{await g.delete(s),m({title:"Success",description:"Item deleted"}),L()}catch{m({title:"Error",description:"Failed to delete",variant:"destructive"})}},M=a.filter(s=>s.name.toLowerCase().includes(q.toLowerCase())||s.item_code.toLowerCase().includes(q.toLowerCase())),V=s=>`ETB ${(s||0).toLocaleString()}`;return e.jsxs(je,{title:"Inventory",subtitle:"Hospital inventory management",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(f,{children:e.jsx(w,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Items"}),e.jsx("p",{className:"text-3xl font-bold",children:(($=o==null?void 0:o.totals)==null?void 0:$.total_items)||0})]}),e.jsx(O,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(f,{children:e.jsx(w,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Stock"}),e.jsx("p",{className:"text-3xl font-bold",children:(((G=o==null?void 0:o.totals)==null?void 0:G.total_stock)||0).toLocaleString()})]}),e.jsx(O,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(f,{children:e.jsx(w,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Low Stock"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:((H=o==null?void 0:o.totals)==null?void 0:H.low_stock_count)||0})]}),e.jsx(Te,{className:"w-8 h-8 text-yellow-600"})]})})}),e.jsx(f,{children:e.jsx(w,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold",children:V(((z=o==null?void 0:o.totals)==null?void 0:z.total_value)||0)})]}),e.jsx(O,{className:"w-8 h-8 text-green-600"})]})})})]}),h.length>0&&e.jsxs(f,{className:"mb-6 border-yellow-500/50",children:[e.jsx(ye,{className:"py-3",children:e.jsxs(_e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-yellow-500"})," Low Stock Alerts (",h.length," items)"]})}),e.jsx(w,{className:"pt-0",children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.slice(0,5).map(s=>e.jsxs(_,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:[s.name,": ",s.stock_quantity,"/",s.min_stock_level]},s.id)),h.length>5&&e.jsxs(_,{variant:"secondary",children:["+",h.length-5," more"]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-xs",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search items...",className:"pl-10",value:q,onChange:s=>re(s.target.value)})]}),e.jsxs(E,{value:S,onValueChange:oe,children:[e.jsx(R,{className:"w-[160px]",children:e.jsx(A,{placeholder:"All Categories"})}),e.jsxs(B,{children:[e.jsx(p,{value:"all",children:"All Categories"}),Y.map(s=>e.jsx(p,{value:s,children:s},s))]})]})]}),e.jsxs(j,{className:"gap-2",onClick:ce,children:[e.jsx(Ne,{className:"w-4 h-4"})," Add Item"]})]}),e.jsx(f,{children:e.jsx(w,{className:"p-0",children:te?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Se,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(fe,{children:[e.jsx(we,{children:e.jsxs(F,{children:[e.jsx(v,{children:"Code"}),e.jsx(v,{children:"Name"}),e.jsx(v,{children:"Category"}),e.jsx(v,{children:"Stock"}),e.jsx(v,{children:"Unit"}),e.jsx(v,{children:"Unit Cost"}),e.jsx(v,{children:"Status"}),e.jsx(v,{children:"Actions"})]})}),e.jsxs(ke,{children:[M.map(s=>e.jsxs(F,{children:[e.jsx(u,{className:"font-mono text-sm",children:s.item_code}),e.jsx(u,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),s.supplier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.supplier})]})}),e.jsx(u,{children:e.jsx(_,{variant:"secondary",children:s.category})}),e.jsxs(u,{children:[e.jsx("span",{className:s.stock_quantity<=s.min_stock_level?"text-red-600 font-bold":"",children:s.stock_quantity}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[" / min ",s.min_stock_level]})]}),e.jsx(u,{className:"text-sm",children:s.unit_of_measure}),e.jsx(u,{className:"text-sm",children:V(s.unit_cost)}),e.jsx(u,{children:s.stock_quantity<=0?e.jsx(_,{variant:"destructive",children:"Out of Stock"}):s.stock_quantity<=s.min_stock_level?e.jsx(_,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Low Stock"}):e.jsx(_,{variant:"default",children:"In Stock"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{le(s),C({transaction_type:"Received",quantity:"",department:"",notes:""}),T(!0)},children:e.jsx(be,{className:"w-3 h-3"})}),e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>ie(s),children:e.jsx(Ce,{className:"w-3 h-3"})}),e.jsx(j,{size:"sm",variant:"ghost",className:"text-red-500",onClick:()=>ue(s.id),children:e.jsx(ge,{className:"w-3 h-3"})})]})})]},s.id)),M.length===0&&e.jsx(F,{children:e.jsx(u,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No items found"})})]})]})})}),e.jsx(Q,{open:ae,onOpenChange:k,children:e.jsxs(K,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(W,{children:e.jsx(J,{children:I?"Edit Item":"Add New Item"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{children:"Name *"}),e.jsx(c,{value:t.name,onChange:s=>l({...t,name:s.target.value}),placeholder:"e.g. Surgical Gloves"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Category"}),e.jsxs(E,{value:t.category,onValueChange:s=>l({...t,category:s}),children:[e.jsx(R,{children:e.jsx(A,{})}),e.jsx(B,{children:Y.map(s=>e.jsx(p,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Unit of Measure"}),e.jsx(c,{value:t.unit_of_measure,onChange:s=>l({...t,unit_of_measure:s.target.value}),placeholder:"Box, Pack, Roll, etc."})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Stock Quantity"}),e.jsx(c,{type:"number",value:t.stock_quantity,onChange:s=>l({...t,stock_quantity:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Min Stock Level"}),e.jsx(c,{type:"number",value:t.min_stock_level,onChange:s=>l({...t,min_stock_level:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Max Stock Level"}),e.jsx(c,{type:"number",value:t.max_stock_level,onChange:s=>l({...t,max_stock_level:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Reorder Level"}),e.jsx(c,{type:"number",value:t.reorder_level,onChange:s=>l({...t,reorder_level:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Unit Cost (ETB)"}),e.jsx(c,{type:"number",value:t.unit_cost,onChange:s=>l({...t,unit_cost:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Supplier"}),e.jsx(c,{value:t.supplier,onChange:s=>l({...t,supplier:s.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{children:"Location"}),e.jsx(c,{value:t.location,onChange:s=>l({...t,location:s.target.value}),placeholder:"e.g. Main Warehouse"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{children:"Description"}),e.jsx(D,{value:t.description,onChange:s=>l({...t,description:s.target.value}),rows:2,placeholder:"Item description..."})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{children:"Notes"}),e.jsx(D,{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),rows:2})]})]}),e.jsxs(X,{children:[e.jsx(j,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),e.jsxs(j,{onClick:de,children:[I?"Update":"Create"," Item"]})]})]})}),e.jsx(Q,{open:ne,onOpenChange:T,children:e.jsxs(K,{className:"max-w-md",children:[e.jsx(W,{children:e.jsxs(J,{children:["Stock Transaction â€” ",N==null?void 0:N.name]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Type"}),e.jsxs(E,{value:d.transaction_type,onValueChange:s=>C({...d,transaction_type:s}),children:[e.jsx(R,{children:e.jsx(A,{})}),e.jsxs(B,{children:[e.jsx(p,{value:"Received",children:"Received (Restock)"}),e.jsx(p,{value:"Issued",children:"Issued (Used)"}),e.jsx(p,{value:"Returned",children:"Returned"}),e.jsx(p,{value:"Adjusted",children:"Adjusted"}),e.jsx(p,{value:"Disposed",children:"Disposed"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Quantity"}),e.jsx(c,{type:"number",value:d.quantity,onChange:s=>C({...d,quantity:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Department"}),e.jsx(c,{value:d.department,onChange:s=>C({...d,department:s.target.value}),placeholder:"e.g. ICU, Emergency"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Notes"}),e.jsx(D,{value:d.notes,onChange:s=>C({...d,notes:s.target.value}),rows:2})]})]}),e.jsxs(X,{children:[e.jsx(j,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(j,{onClick:xe,children:"Record Transaction"})]})]})})]})};export{$e as default};
