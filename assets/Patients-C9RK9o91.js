import{r as d,j as e,d as G}from"./index-D78T4imR.js";import{c as H,S as _,A as z,a as R,B as F,D as U,e as J,f as K,g as D}from"./AdminLayout-BtskhTy9.js";import{B as v,C as Q,d as W}from"./card-C-gqQ2Kk.js";import{I as j}from"./Combination-_iD594Rc.js";import{T as X,a as Y,b as P,c as o,d as Z,e as c}from"./table-C3lzzPFT.js";import{D as ee,a as se,b as ae,c as te,d as re,E as ie,S as ne,T as le,e as ce}from"./DeleteConfirmDialog-DGUrLfLj.js";import{L as m}from"./label-w-1BiFyq.js";import{S as T,a as E,b as L,c as V,d as x}from"./select-DRVA5bys.js";import{p as b}from"./patientService-BRDsGSW5.js";import{F as de}from"./filter-DUxkrc72.js";import{P as oe}from"./plus-DSx3Cbm8.js";import{L as he}from"./loader-circle-B7-Z8OSf.js";import{E as me}from"./eye-CYehyE3Z.js";import"./index-Dldki3LP.js";const I={name:"",age:0,gender:"Male",phone:"",lastVisit:new Date().toISOString().split("T")[0],status:"Active",insurance:""};function ue({open:f,onOpenChange:g,patient:r,onSave:N}){const[a,l]=d.useState(I);d.useEffect(()=>{l(r?{name:r.name,age:r.age,gender:r.gender,phone:r.phone,lastVisit:r.lastVisit,status:r.status,insurance:r.insurance}:I)},[r,f]);const w=t=>{t.preventDefault(),N(r?{...a,id:r.id}:a),g(!1)};return e.jsx(ee,{open:f,onOpenChange:g,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsx(ae,{children:e.jsx(te,{children:r?"Edit Patient":"Add New Patient"})}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Full Name"}),e.jsx(j,{id:"name",value:a.name,onChange:t=>l({...a,name:t.target.value}),required:!0,maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"age",children:"Age"}),e.jsx(j,{id:"age",type:"number",min:0,max:150,value:a.age,onChange:t=>l({...a,age:parseInt(t.target.value)||0}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"gender",children:"Gender"}),e.jsxs(T,{value:a.gender,onValueChange:t=>l({...a,gender:t}),children:[e.jsx(E,{children:e.jsx(L,{})}),e.jsxs(V,{children:[e.jsx(x,{value:"Male",children:"Male"}),e.jsx(x,{value:"Female",children:"Female"}),e.jsx(x,{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",children:"Phone"}),e.jsx(j,{id:"phone",value:a.phone,onChange:t=>l({...a,phone:t.target.value}),required:!0,maxLength:20})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"status",children:"Status"}),e.jsxs(T,{value:a.status,onValueChange:t=>l({...a,status:t}),children:[e.jsx(E,{children:e.jsx(L,{})}),e.jsxs(V,{children:[e.jsx(x,{value:"Active",children:"Active"}),e.jsx(x,{value:"Discharged",children:"Discharged"}),e.jsx(x,{value:"Critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"insurance",children:"Insurance Provider"}),e.jsx(j,{id:"insurance",value:a.insurance,onChange:t=>l({...a,insurance:t.target.value}),required:!0,maxLength:50})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"lastVisit",children:"Last Visit"}),e.jsx(j,{id:"lastVisit",type:"date",value:a.lastVisit,onChange:t=>l({...a,lastVisit:t.target.value})})]})]}),e.jsxs(re,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsxs(v,{type:"submit",children:[r?"Update":"Add"," Patient"]})]})]})]})})}const M={Active:"bg-success/10 text-success border-success/20",Discharged:"bg-muted text-muted-foreground border-border",Critical:"bg-destructive/10 text-destructive border-destructive/20"},Ae=()=>{const[f,g]=d.useState([]),[r,N]=d.useState(!0),[a,l]=d.useState(""),[w,t]=d.useState(!1),[O,C]=d.useState(!1),[h,p]=d.useState(null),{toast:u}=G();d.useEffect(()=>{S()},[]);const S=async()=>{var s,i;try{N(!0);const n=await b.getAll({limit:100});g(n.data||[])}catch(n){u({title:"Error",description:((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to load patients",variant:"destructive"})}finally{N(!1)}},A=f.filter(s=>{var i,n,y;return((i=s.name)==null?void 0:i.toLowerCase().includes(a.toLowerCase()))||((n=s.patient_id)==null?void 0:n.toLowerCase().includes(a.toLowerCase()))||((y=s.phone)==null?void 0:y.includes(a))}),k=async s=>{var i,n;try{s.id?(await b.update(s.id,s),u({title:"Patient Updated",description:`${s.name} has been updated.`})):(await b.create(s),u({title:"Patient Added",description:`${s.name} has been added.`})),S(),p(null),t(!1)}catch(y){u({title:"Error",description:((n=(i=y.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to save patient",variant:"destructive"})}},B=async()=>{var s,i;if(h)try{await b.delete(h.id),u({title:"Patient Deleted",description:`${h.name} has been removed.`,variant:"destructive"}),S(),p(null)}catch(n){u({title:"Error",description:((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to delete patient",variant:"destructive"})}C(!1)},q=s=>{p(s),t(!0)},$=s=>{p(s),C(!0)};return e.jsxs(H,{title:"Patients",subtitle:"Manage patient records and information",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search patients...",className:"pl-10",value:a,onChange:s=>l(s.target.value)})]}),e.jsx(v,{variant:"outline",size:"icon",children:e.jsx(de,{className:"w-4 h-4"})})]}),e.jsxs(v,{className:"gap-2",onClick:()=>{p(null),t(!0)},children:[e.jsx(oe,{className:"w-4 h-4"}),"Add Patient"]})]}),e.jsx(Q,{children:e.jsx(W,{className:"p-0",children:r?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(he,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(P,{children:[e.jsx(o,{children:"Patient ID"}),e.jsx(o,{children:"Patient"}),e.jsx(o,{children:"Age/Gender"}),e.jsx(o,{children:"Phone"}),e.jsx(o,{children:"Blood Group"}),e.jsx(o,{children:"Address"}),e.jsx(o,{children:"Status"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsxs(Z,{children:[A.map(s=>{var i;return e.jsxs(P,{className:"group",children:[e.jsx(c,{className:"font-mono text-sm",children:s.patient_id}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"h-9 w-9",children:e.jsx(R,{className:"bg-primary/10 text-primary text-sm",children:(i=s.name)==null?void 0:i.split(" ").map(n=>n[0]).join("").substring(0,2)})}),e.jsx("span",{className:"font-medium",children:s.name})]})}),e.jsxs(c,{children:[s.age,"y / ",s.gender]}),e.jsx(c,{className:"text-muted-foreground",children:s.phone}),e.jsx(c,{children:e.jsx(F,{variant:"secondary",children:s.blood_group||"N/A"})}),e.jsx(c,{className:"text-muted-foreground max-w-[200px] truncate",children:s.address||"N/A"}),e.jsx(c,{children:e.jsx(F,{variant:"outline",className:M[s.status]||M.Active,children:s.status})}),e.jsx(c,{className:"text-right",children:e.jsxs(U,{children:[e.jsx(J,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:e.jsx(ie,{className:"w-4 h-4"})})}),e.jsxs(K,{align:"end",children:[e.jsxs(D,{className:"gap-2",onClick:()=>window.location.href=`/patients/${s.id}`,children:[e.jsx(me,{className:"w-4 h-4"})," View Details"]}),e.jsxs(D,{className:"gap-2",onClick:()=>q(s),children:[e.jsx(ne,{className:"w-4 h-4"})," Edit"]}),e.jsxs(D,{className:"gap-2 text-destructive",onClick:()=>$(s),children:[e.jsx(le,{className:"w-4 h-4"})," Delete"]})]})]})})]},s.id)}),A.length===0&&!r&&e.jsx(P,{children:e.jsx(c,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No patients found"})})]})]})})}),e.jsx(ue,{open:w,onOpenChange:t,patient:h,onSave:k}),e.jsx(ce,{open:O,onOpenChange:C,title:"Delete Patient",description:`Are you sure you want to delete ${h==null?void 0:h.name}? This action cannot be undone.`,onConfirm:B})]})};export{Ae as default};
