import{r as n,d as k,j as e}from"./index-BM0IHp2M.js";import{c as P,L as v,h as U,S as F,B as w,F as u}from"./AdminLayout-CWUWmsnS.js";import{C as j,d as p,B as g}from"./card-DeprxXCB.js";import{I}from"./Combination-DWTH6IhY.js";import{L as o}from"./label-PzrI3jAD.js";import{T as O,a as H,b as f,c as i,d as R,e as t}from"./table-BzDp6Nnk.js";import{D as V,a as z,b as W,c as q,e as G,d as J}from"./dialog-DCRhT7_F.js";import{i as K}from"./admissionService-BasvtlDv.js";import{S as M}from"./separator-DBuYGobr.js";import{L as Q}from"./loader-circle-aBlEtCJL.js";import{E as X}from"./eye-Dp2HsTK1.js";const le=()=>{const[m,y]=n.useState([]),[N,D]=n.useState(!0),[l,_]=n.useState(""),{toast:C}=k(),[S,x]=n.useState(!1),[a,T]=n.useState(null);n.useEffect(()=>{L()},[]);const L=async()=>{var s,r;try{D(!0);const c=((await K.getAll({limit:100})).data||[]).filter(E=>E.status==="Discharged");y(c)}catch(d){C({title:"Error",description:((r=(s=d.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to load discharges",variant:"destructive"})}finally{D(!1)}},A=s=>{T(s),x(!0)},b=m.filter(s=>{var r,d,c;return((r=s.patient_name)==null?void 0:r.toLowerCase().includes(l.toLowerCase()))||((d=s.admission_id)==null?void 0:d.toLowerCase().includes(l.toLowerCase()))||((c=s.admission_number)==null?void 0:c.toLowerCase().includes(l.toLowerCase()))}),h=s=>s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A",B=s=>s?new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e.jsxs(P,{title:"Discharge",subtitle:"Patient discharge management",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(j,{children:e.jsx(p,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Discharged"}),e.jsx("p",{className:"text-3xl font-bold",children:m.length})]}),e.jsx(v,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(j,{children:e.jsx(p,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed Today"}),e.jsx("p",{className:"text-3xl font-bold text-success",children:m.filter(s=>{if(!s.actual_discharge_date)return!1;const r=new Date().toDateString();return new Date(s.actual_discharge_date).toDateString()===r}).length})]}),e.jsx(U,{className:"w-8 h-8 text-success"})]})})})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search discharges...",className:"pl-10",value:l,onChange:s=>_(s.target.value)})]})}),e.jsx(j,{children:e.jsx(p,{className:"p-0",children:N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(O,{children:[e.jsx(H,{children:e.jsxs(f,{children:[e.jsx(i,{children:"Admission ID"}),e.jsx(i,{children:"Patient"}),e.jsx(i,{children:"Doctor"}),e.jsx(i,{children:"Admitted"}),e.jsx(i,{children:"Discharged"}),e.jsx(i,{children:"Type"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsxs(R,{children:[b.map(s=>e.jsxs(f,{children:[e.jsx(t,{className:"font-mono text-sm",children:s.admission_id||s.admission_number}),e.jsx(t,{className:"font-medium",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.patient_name||"Unknown"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.patient_code})]})}),e.jsx(t,{children:s.doctor_name||"Unassigned"}),e.jsx(t,{children:h(s.admission_date)}),e.jsx(t,{children:h(s.actual_discharge_date||s.discharge_date)}),e.jsx(t,{children:e.jsx(w,{variant:"outline",className:"border-muted text-muted-foreground",children:s.discharge_type||"Normal"})}),e.jsx(t,{className:"text-right",children:e.jsxs(g,{variant:"ghost",size:"sm",onClick:()=>A(s),children:[e.jsx(X,{className:"w-4 h-4 mr-1"})," View"]})})]},s.id)),b.length===0&&!N&&e.jsx(f,{children:e.jsx(t,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No discharge records found"})})]})]})})}),e.jsx(V,{open:S,onOpenChange:x,children:e.jsxs(z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(W,{children:[e.jsx(q,{children:"Discharge Summary"}),e.jsx(G,{children:"Detailed view of discharge record"})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start bg-muted/30 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:a.patient_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",a.patient_code]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Phone: ",a.patient_phone||"N/A"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(w,{variant:a.status==="Discharged"?"secondary":"default",className:"mb-1",children:a.status}),e.jsx("p",{className:"text-sm font-mono",children:a.admission_id})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 border p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-muted-foreground text-xs uppercase",children:"Admission Date"}),e.jsx("p",{className:"font-medium",children:h(a.admission_date)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-muted-foreground text-xs uppercase",children:"Discharge Date"}),e.jsx("p",{className:"font-medium",children:B(a.actual_discharge_date)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-muted-foreground text-xs uppercase",children:"Attending Doctor"}),e.jsx("p",{className:"font-medium",children:a.doctor_name||"Unassigned"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-muted-foreground text-xs uppercase",children:"Department/Ward"}),e.jsxs("p",{className:"font-medium",children:[a.ward_name||"N/A"," - ",a.bed_number||"N/A"]})]})]}),e.jsx(M,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2 mb-2",children:[e.jsx(u,{className:"w-4 h-4"})," Diagnosis"]}),e.jsx("div",{className:"bg-muted/20 p-3 rounded-md text-sm",children:a.admitting_diagnosis||a.diagnosis||"No diagnosis recorded"})]}),a.treatment_plan&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2 mb-2",children:[e.jsx(u,{className:"w-4 h-4"})," Treatment Plan"]}),e.jsx("div",{className:"bg-muted/20 p-3 rounded-md text-sm",children:a.treatment_plan})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2 mb-2",children:[e.jsx(v,{className:"w-4 h-4"})," Discharge Summary"]}),e.jsxs("div",{className:"bg-muted/20 p-3 rounded-md text-sm whitespace-pre-wrap",children:[e.jsxs("p",{className:"font-semibold mb-1",children:["Type: ",a.discharge_type]}),a.discharge_summary||"No summary notes available."]})]})]})]}),e.jsxs(J,{children:[e.jsxs(g,{variant:"outline",onClick:()=>window.print(),children:[e.jsx(u,{className:"w-4 h-4 mr-2"})," Print Summary"]}),e.jsx(g,{onClick:()=>x(!1),children:"Close"})]})]})})]})};export{le as default};
