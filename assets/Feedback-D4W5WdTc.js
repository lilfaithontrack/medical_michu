import{c as K,f as g,r,d as ve,j as e}from"./index-BM0IHp2M.js";import{c as ye,u as Ne,S as we,B as P,T as ke}from"./AdminLayout-CWUWmsnS.js";import{C,d as F,B as o}from"./card-DeprxXCB.js";import{T as ee}from"./textarea-DWoGW9ma.js";import{I as se}from"./Combination-DWTH6IhY.js";import{L as l}from"./label-PzrI3jAD.js";import{D as $,a as H,b as M,c as z,d as I}from"./dialog-DCRhT7_F.js";import{S as T,a as _,b as O,c as D,d as f}from"./select-OA5PXWO7.js";import{T as Se,a as be,b as q,c as p,d as Ce,e as h}from"./table-BzDp6Nnk.js";import{S as ae}from"./star-Cyd1n-zf.js";import{F as Fe}from"./filter-MpqZckG0.js";import{P as Te}from"./plus-BoDGEuOf.js";import{L as _e}from"./loader-circle-aBlEtCJL.js";import{E as De}from"./eye-Dp2HsTK1.js";import{S as Ae}from"./square-pen-D0IrTuyB.js";import"./index-yV4U6faZ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=K("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=K("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=K("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),v={getAll:async c=>(await g.get("/feedback",{params:c})).data,getById:async c=>(await g.get(`/feedback/${c}`)).data,create:async c=>(await g.post("/feedback",c)).data,update:async(c,m)=>(await g.put(`/feedback/${c}`,m)).data,delete:async c=>(await g.delete(`/feedback/${c}`)).data,respond:async(c,m)=>(await g.post(`/feedback/${c}/respond`,m)).data,getStats:async()=>(await g.get("/feedback/stats")).data},te=["Service","Staff","Facility","Food","Cleanliness","General"],G=["Pending","Reviewed","Resolved","Archived"],We=()=>{const[c,m]=r.useState([]),[d,ne]=r.useState(null),[re,Y]=r.useState(!0),[le,y]=r.useState(!1),[ce,N]=r.useState(!1),[de,A]=r.useState(!1),[w,Z]=r.useState(null),[a,W]=r.useState(null),[k,ie]=r.useState(""),[S,oe]=r.useState(""),[R,xe]=r.useState(""),[V,E]=r.useState(""),[J,B]=r.useState(5),[i,j]=r.useState({feedback_type:"General",comment:"",department:"",is_anonymous:!1,status:"Pending"}),{toast:x}=ve();r.useEffect(()=>{b()},[k,S]);const b=async()=>{var s,t;try{Y(!0);const n={limit:50};k&&k!=="all"&&(n.feedback_type=k),S&&S!=="all"&&(n.status=S);const[u,fe]=await Promise.all([v.getAll(n),v.getStats()]);m(u.data||[]),ne(fe)}catch(n){x({title:"Error",description:((t=(s=n.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load feedback",variant:"destructive"})}finally{Y(!1)}},me=()=>{Z(null),j({feedback_type:"General",comment:"",department:"",is_anonymous:!1,status:"Pending"}),B(5),y(!0)},he=s=>{Z(s),j({feedback_type:s.feedback_type,comment:s.comment||"",department:s.department||"",is_anonymous:s.is_anonymous||!1,status:s.status}),B(s.rating),y(!0)},ue=async()=>{var s,t;try{const n={...i,rating:J};w?(await v.update(w.id,n),x({title:"Success",description:"Feedback updated successfully"})):(await v.create(n),x({title:"Success",description:"Feedback submitted successfully"})),y(!1),b()}catch(n){x({title:"Error",description:((t=(s=n.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to save feedback",variant:"destructive"})}},pe=async()=>{if(!(!a||!V))try{await v.respond(a.id,{response:V}),x({title:"Success",description:"Response submitted"}),N(!1),E(""),b()}catch{x({title:"Error",description:"Failed to respond",variant:"destructive"})}},je=async(s,t)=>{try{await v.update(s,{status:t}),x({title:"Success",description:`Status updated to ${t}`}),b()}catch{x({title:"Error",description:"Failed to update status",variant:"destructive"})}},ge=async s=>{try{await v.delete(s),x({title:"Success",description:"Feedback deleted"}),b()}catch{x({title:"Error",description:"Failed to delete",variant:"destructive"})}},Q=c.filter(s=>{var t,n,u;return((t=s.comment)==null?void 0:t.toLowerCase().includes(R.toLowerCase()))||((n=s.patient_name)==null?void 0:n.toLowerCase().includes(R.toLowerCase()))||((u=s.department)==null?void 0:u.toLowerCase().includes(R.toLowerCase()))}),L=(s,t=!1,n)=>e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(u=>e.jsx(ae,{className:`w-4 h-4 ${t?"cursor-pointer":""} ${u<=s?"text-yellow-500 fill-yellow-500":"text-gray-300"}`,onClick:()=>t&&(n==null?void 0:n(u))},u))}),X=s=>{switch(s){case"Resolved":return"default";case"Reviewed":return"secondary";case"Archived":return"outline";default:return"outline"}};return e.jsxs(ye,{title:"Feedback",subtitle:"Patient feedback and satisfaction tracking",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(C,{children:e.jsx(F,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Feedback"}),e.jsx("p",{className:"text-3xl font-bold",children:(d==null?void 0:d.overall.total)||0})]}),e.jsx(Ne,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(C,{children:e.jsx(F,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Rating"}),e.jsx("p",{className:"text-3xl font-bold",children:(d==null?void 0:d.overall.avg_rating)||"0.0"})]}),e.jsx(ae,{className:"w-8 h-8 text-yellow-500 fill-yellow-500"})]})})}),e.jsx(C,{children:e.jsx(F,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Positive"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[(d==null?void 0:d.overall.positive_percent)||0,"%"]})]}),e.jsx(Ee,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(C,{children:e.jsx(F,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Negative"}),e.jsxs("p",{className:"text-3xl font-bold text-red-600",children:[(d==null?void 0:d.overall.negative_percent)||0,"%"]})]}),e.jsx(Re,{className:"w-8 h-8 text-red-600"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between mb-6",children:[e.jsxs("div",{className:"flex gap-3 items-center flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-xs",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Search feedback...",className:"pl-10",value:R,onChange:s=>xe(s.target.value)})]}),e.jsxs(T,{value:k,onValueChange:ie,children:[e.jsxs(_,{className:"w-[150px]",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),e.jsx(O,{placeholder:"All Types"})]}),e.jsxs(D,{children:[e.jsx(f,{value:"all",children:"All Types"}),te.map(s=>e.jsx(f,{value:s,children:s},s))]})]}),e.jsxs(T,{value:S,onValueChange:oe,children:[e.jsx(_,{className:"w-[140px]",children:e.jsx(O,{placeholder:"All Status"})}),e.jsxs(D,{children:[e.jsx(f,{value:"all",children:"All Status"}),G.map(s=>e.jsx(f,{value:s,children:s},s))]})]})]}),e.jsxs(o,{className:"gap-2",onClick:me,children:[e.jsx(Te,{className:"w-4 h-4"})," New Feedback"]})]}),e.jsx(C,{children:e.jsx(F,{className:"p-0",children:re?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(_e,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs(Se,{children:[e.jsx(be,{children:e.jsxs(q,{children:[e.jsx(p,{children:"Patient"}),e.jsx(p,{children:"Type"}),e.jsx(p,{children:"Rating"}),e.jsx(p,{children:"Comment"}),e.jsx(p,{children:"Department"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Date"}),e.jsx(p,{children:"Actions"})]})}),e.jsxs(Ce,{children:[Q.map(s=>e.jsxs(q,{children:[e.jsx(h,{className:"font-medium",children:s.is_anonymous?"Anonymous":s.patient_name||"N/A"}),e.jsx(h,{children:e.jsx(P,{variant:"secondary",children:s.feedback_type})}),e.jsx(h,{children:L(s.rating)}),e.jsx(h,{className:"max-w-[200px] truncate",children:s.comment}),e.jsx(h,{children:s.department||"N/A"}),e.jsx(h,{children:e.jsxs(T,{value:s.status,onValueChange:t=>je(s.id,t),children:[e.jsx(_,{className:"h-7 w-[110px] text-xs",children:e.jsx(P,{variant:X(s.status),className:"text-xs",children:s.status})}),e.jsx(D,{children:G.map(t=>e.jsx(f,{value:t,children:t},t))})]})}),e.jsx(h,{className:"text-sm",children:new Date(s.created_at).toLocaleDateString()}),e.jsx(h,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>{W(s),A(!0)},children:e.jsx(De,{className:"w-3 h-3"})}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>he(s),children:e.jsx(Ae,{className:"w-3 h-3"})}),s.status==="Pending"&&e.jsx(o,{size:"sm",variant:"outline",onClick:()=>{W(s),E(""),N(!0)},children:e.jsx(U,{className:"w-3 h-3"})}),e.jsx(o,{size:"sm",variant:"ghost",className:"text-red-500",onClick:()=>ge(s.id),children:e.jsx(ke,{className:"w-3 h-3"})})]})})]},s.id)),Q.length===0&&e.jsx(q,{children:e.jsx(h,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No feedback found"})})]})]})})}),e.jsx($,{open:le,onOpenChange:y,children:e.jsxs(H,{className:"max-w-md",children:[e.jsx(M,{children:e.jsx(z,{children:w?"Edit Feedback":"Submit New Feedback"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Feedback Type *"}),e.jsxs(T,{value:i.feedback_type,onValueChange:s=>j({...i,feedback_type:s}),children:[e.jsx(_,{children:e.jsx(O,{})}),e.jsx(D,{children:te.map(s=>e.jsx(f,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Rating *"}),L(J,!0,B)]}),e.jsxs("div",{children:[e.jsx(l,{children:"Department"}),e.jsx(se,{value:i.department,onChange:s=>j({...i,department:s.target.value}),placeholder:"e.g. Emergency, OPD, Ward A"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Comment"}),e.jsx(ee,{value:i.comment,onChange:s=>j({...i,comment:s.target.value}),placeholder:"Enter feedback details...",rows:4})]}),w&&e.jsxs("div",{children:[e.jsx(l,{children:"Status"}),e.jsxs(T,{value:i.status,onValueChange:s=>j({...i,status:s}),children:[e.jsx(_,{children:e.jsx(O,{})}),e.jsx(D,{children:G.map(s=>e.jsx(f,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"anonymous",checked:i.is_anonymous,onChange:s=>j({...i,is_anonymous:s.target.checked})}),e.jsx(l,{htmlFor:"anonymous",children:"Submit Anonymously"})]})]}),e.jsxs(I,{children:[e.jsx(o,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsxs(o,{onClick:ue,children:[w?"Update":"Submit"," Feedback"]})]})]})}),e.jsx($,{open:ce,onOpenChange:N,children:e.jsxs(H,{className:"max-w-md",children:[e.jsx(M,{children:e.jsx(z,{children:"Respond to Feedback"})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:a.patient_name||"Anonymous"}),L(a.rating)]}),e.jsx("p",{className:"text-sm",children:a.comment})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Your Response *"}),e.jsx(ee,{value:V,onChange:s=>E(s.target.value),placeholder:"Enter your response...",rows:4})]})]}),e.jsxs(I,{children:[e.jsx(o,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsxs(o,{onClick:pe,className:"gap-2",children:[e.jsx(U,{className:"w-4 h-4"})," Send Response"]})]})]})}),e.jsx($,{open:de,onOpenChange:A,children:e.jsxs(H,{className:"max-w-lg",children:[e.jsx(M,{children:e.jsx(z,{children:"Feedback Details"})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Patient"}),e.jsx("p",{className:"font-medium",children:a.is_anonymous?"Anonymous":a.patient_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Type"}),e.jsx("p",{children:e.jsx(P,{variant:"secondary",children:a.feedback_type})})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Rating"}),L(a.rating)]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Department"}),e.jsx("p",{children:a.department||"N/A"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Status"}),e.jsx("p",{children:e.jsx(P,{variant:X(a.status),children:a.status})})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Date"}),e.jsx("p",{children:new Date(a.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Comment"}),e.jsx("div",{className:"bg-muted p-3 rounded-md mt-1",children:e.jsx("p",{className:"text-sm",children:a.comment||"No comment"})})]}),a.response&&e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-xs",children:"Response"}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-md mt-1 border border-blue-200",children:[e.jsx("p",{className:"text-sm",children:a.response}),a.responded_at&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Responded: ",new Date(a.responded_at).toLocaleDateString()]})]})]})]}),e.jsxs(I,{children:[e.jsx(o,{variant:"outline",onClick:()=>A(!1),children:"Close"}),a&&a.status==="Pending"&&e.jsxs(o,{onClick:()=>{A(!1),E(""),N(!0)},className:"gap-2",children:[e.jsx(U,{className:"w-4 h-4"})," Respond"]})]})]})})]})};export{We as default};
