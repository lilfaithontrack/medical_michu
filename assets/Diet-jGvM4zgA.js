import{c as y,f as r,r as c,d as Z,j as e}from"./index-MFUeX4KC.js";import{c as H,i as U,B as S}from"./AdminLayout-CEyGcOXW.js";import{C as l,d,B as j,a as w,b as D}from"./card--ujVzSXa.js";import{D as z,a as G,b as J,c as K,d as Q}from"./dialog-C_l7gpm1.js";import{L as m}from"./label-Cw8AwbsX.js";import{I as W}from"./Combination-CVDpaV-S.js";import{S as C,a as T,b as P,c as k,d as A}from"./select-CM0PFwtY.js";import{T as X}from"./textarea-BWkPO5tB.js";import{p as Y}from"./patientService-CtAKoHA_.js";import{P as ee}from"./plus-DrrZjkgX.js";import{L}from"./loader-circle-DYBsGSuP.js";import"./index-lz0iHb9C.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=y("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=y("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=y("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]),M={getAll:async(s={})=>(await r.get("/diet",{params:s})).data,getStats:async()=>(await r.get("/diet/stats")).data.data,getById:async s=>(await r.get(`/diet/${s}`)).data.data,create:async s=>(await r.post("/diet",s)).data.data,updateStatus:async(s,n)=>(await r.put(`/diet/${s}/status`,{status:n})).data.data,delete:async s=>{await r.delete(`/diet/${s}`)},getByPatient:async s=>(await r.get(`/diet/patient/${s}`)).data.data},B={Regular:"bg-success/10 text-success",Diabetic:"bg-warning/10 text-warning","Low Sodium":"bg-info/10 text-info",Liquid:"bg-purple-500/10 text-purple-500",NPO:"bg-destructive/10 text-destructive"},je=()=>{var b,v;const[s,n]=c.useState(null),[o,I]=c.useState(!0),{toast:u}=Z(),[O,p]=c.useState(!1),[_,V]=c.useState([]),[a,x]=c.useState({patient_id:"",type:"Regular",start_date:new Date().toISOString().split("T")[0],instructions:""}),[g,f]=c.useState(!1);c.useEffect(()=>{N(),E()},[]);const N=async()=>{try{const t=await M.getStats();n(t)}catch(t){console.error("Failed to fetch diet stats:",t)}finally{I(!1)}},E=async()=>{try{const t=await Y.getAll({limit:100});V(t.data||[])}catch(t){console.error("Failed to fetch patients:",t)}},F=async()=>{var t,i;if(!a.patient_id){u({title:"Error",description:"Please select a patient",variant:"destructive"});return}try{f(!0),await M.create(a),u({title:"Success",description:"Diet plan created successfully"}),p(!1),N(),x({...a,patient_id:"",instructions:""})}catch(h){u({title:"Error",description:((i=(t=h.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to create diet plan",variant:"destructive"})}finally{f(!1)}},R=()=>s!=null&&s.byType?s.byType.reduce((t,i)=>t+i.count,0):0,q=t=>{var i;return((i=s==null?void 0:s.byType.find(h=>h.type===t))==null?void 0:i.count)||0},$=()=>s!=null&&s.byType?s.byType.filter(t=>t.type!=="Regular").reduce((t,i)=>t+i.count,0):0;return e.jsxs(H,{title:"Diet & Nutrition",subtitle:"Manage patient dietary requirements",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(l,{children:e.jsx(d,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Active Plans"}),e.jsx("p",{className:"text-3xl font-bold",children:o?"...":R()})]}),e.jsx(ae,{className:"w-8 h-8 text-muted-foreground"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Diet Types"}),e.jsx("p",{className:"text-3xl font-bold",children:((b=s==null?void 0:s.byType)==null?void 0:b.length)||0})]}),e.jsx(te,{className:"w-8 h-8 text-success"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Special Diets"}),e.jsx("p",{className:"text-3xl font-bold",children:o?"...":$()})]}),e.jsx(se,{className:"w-8 h-8 text-warning"})]})})}),e.jsx(l,{children:e.jsx(d,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"NPO"}),e.jsx("p",{className:"text-3xl font-bold text-destructive",children:o?"...":q("NPO")})]}),e.jsx(U,{className:"w-8 h-8 text-destructive"})]})})})]}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs(j,{onClick:()=>p(!0),className:"gap-2",children:[e.jsx(ee,{className:"w-4 h-4"})," Assign Diet Plan"]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg",children:"Diet Plans Distribution"})}),e.jsx(d,{className:"space-y-3",children:o?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(L,{className:"animate-spin"})}):((v=s==null?void 0:s.byType)==null?void 0:v.map(t=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b last:border-0",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(S,{className:B[t.type]||"bg-secondary text-secondary-foreground",children:t.type})}),e.jsxs("span",{className:"font-bold",children:[t.count," patients"]})]},t.type)))||e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No data available"})})]}),e.jsxs(l,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg",children:"Meal Schedule (Standard)"})}),e.jsx(d,{className:"space-y-3",children:[{meal:"Breakfast",time:"07:00 - 08:00"},{meal:"Lunch",time:"12:00 - 13:00"},{meal:"Dinner",time:"18:00 - 19:00"}].map(t=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.meal}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.time})]}),e.jsx(S,{variant:"outline",children:"Scheduled"})]},t.meal))})]})]}),e.jsx(z,{open:O,onOpenChange:p,children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsx(K,{children:"Assign Diet Plan"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Patient"}),e.jsxs(C,{onValueChange:t=>x({...a,patient_id:t}),children:[e.jsx(T,{children:e.jsx(P,{placeholder:"Select Patient"})}),e.jsx(k,{className:"max-h-60",children:_.map(t=>e.jsx(A,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Diet Type"}),e.jsxs(C,{defaultValue:"Regular",onValueChange:t=>x({...a,type:t}),children:[e.jsx(T,{children:e.jsx(P,{})}),e.jsx(k,{children:Object.keys(B).map(t=>e.jsx(A,{value:t,children:t},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Start Date"}),e.jsx(W,{type:"date",value:a.start_date,onChange:t=>x({...a,start_date:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Instructions"}),e.jsx(X,{placeholder:"Specific dietary instructions...",value:a.instructions,onChange:t=>x({...a,instructions:t.target.value})})]})]}),e.jsxs(Q,{children:[e.jsx(j,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsxs(j,{onClick:F,disabled:g,children:[g&&e.jsx(L,{className:"mr-2 h-4 w-4 animate-spin"}),"Assign Plan"]})]})]})})]})};export{je as default};
