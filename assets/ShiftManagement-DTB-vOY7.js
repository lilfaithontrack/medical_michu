import{c as j,f as h,r,d as V,j as e}from"./index-MFUeX4KC.js";import{c as z,d as q,B as w,C as H}from"./AdminLayout-CEyGcOXW.js";import{B as x,C as b,d as k,a as P,b as $}from"./card--ujVzSXa.js";import{s as U}from"./staffService-DIBXRwRi.js";import{D as Z,a as G,b as J,c as K,d as Q}from"./dialog-C_l7gpm1.js";import{L as f}from"./label-Cw8AwbsX.js";import{S as C,a as M,b as D,c as A,d as m}from"./select-CM0PFwtY.js";import{I as u}from"./Combination-CVDpaV-S.js";import{P as W}from"./plus-DrrZjkgX.js";import{L as X}from"./loader-circle-DYBsGSuP.js";import"./index-lz0iHb9C.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=j("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=j("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=j("Sunset",[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]),L={async getAll(s={}){return(await h.get("/shifts",{params:s})).data.data},async getCurrent(){return(await h.get("/shifts/current")).data.data},async getById(s){return(await h.get(`/shifts/${s}`)).data.data},async create(s){return(await h.post("/shifts",s)).data.data},async update(s,l){return(await h.put(`/shifts/${s}`,l)).data.data},async delete(s){await h.delete(`/shifts/${s}`)}},me=()=>{const[s,l]=r.useState([]),[y,v]=r.useState(!0),[T,F]=r.useState([]),[E,g]=r.useState(!1),[c,O]=r.useState(new Date().toISOString().split("T")[0]),[n,d]=r.useState({staff_id:"",shift_type:"Morning",shift_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"16:00"}),{toast:p}=V();r.useEffect(()=>{S(),R()},[c]);const S=async()=>{var t,a;try{v(!0);const i=await L.getAll({start_date:c,end_date:c});console.log("Fetched Shifts Data:",i),l(i||[])}catch(i){p({title:"Error",description:((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load shifts",variant:"destructive"})}finally{v(!1)}},R=async()=>{try{const t=await U.getAll({limit:100});F(t.data||[])}catch{console.error("Failed to load staff list")}},N={Morning:s.filter(t=>t.shift_type==="Morning"),Afternoon:s.filter(t=>t.shift_type==="Afternoon"),Night:s.filter(t=>t.shift_type==="Night"),Rotating:s.filter(t=>t.shift_type==="Rotating")},_={Morning:ee,Afternoon:te,Night:Y,Rotating:H},B={Morning:"bg-warning/10 text-warning border-warning/20",Afternoon:"bg-orange-500/10 text-orange-500 border-orange-500/20",Night:"bg-purple-500/10 text-purple-500 border-purple-500/20",Rotating:"bg-info/10 text-info border-info/20"},I=async()=>{var t,a;if(!n.staff_id){p({title:"Error",description:"Please select a staff member",variant:"destructive"});return}try{await L.create({...n,end_time:n.end_time+":00",start_time:n.start_time+":00"}),p({title:"Success",description:"Shift assigned successfully"}),g(!1),S()}catch(i){p({title:"Error",description:((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to assign shift",variant:"destructive"})}};return e.jsxs(z,{title:"Shift Management",subtitle:"Manage staff shifts and schedules",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-md border shadow-sm",children:[e.jsx(q,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Viewing Schedule For:"}),e.jsx("input",{type:"date",value:c,onChange:t=>{O(t.target.value),d({...n,shift_date:t.target.value})},className:"border-none focus:ring-0 text-sm font-medium"})]}),e.jsxs(x,{className:"gap-2",onClick:()=>g(!0),children:[e.jsx(W,{className:"w-4 h-4"}),"Assign ",new Date(c).toLocaleDateString("en-US",{weekday:"long"})," Shift"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:Object.entries(N).map(([t,a])=>{const i=_[t];return e.jsx(b,{children:e.jsx(k,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t," Shift"]}),e.jsx("p",{className:"text-3xl font-bold",children:a.length})]}),e.jsx(i,{className:"w-8 h-8 text-muted-foreground"})]})})},t)})}),y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Object.entries(N).map(([t,a])=>{const i=_[t];return e.jsxs(b,{className:"h-full",children:[e.jsx(P,{className:"pb-2",children:e.jsxs($,{className:"text-lg flex items-center gap-2",children:[e.jsx(i,{className:"w-5 h-5"}),t," Shift",e.jsxs(w,{variant:"secondary",className:"ml-auto",children:[a.length," staff"]})]})}),e.jsx(k,{children:a.length>0?e.jsx("div",{className:"space-y-2",children:a.map(o=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.staff_name||"Unknown Staff"}),e.jsxs("div",{className:"flex gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:o.staff_role}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[o.start_time.substring(0,5)," - ",o.end_time.substring(0,5)]})]})]}),e.jsx(w,{variant:"outline",className:B[t],children:o.status})]},o.id))}):e.jsxs("p",{className:"text-sm text-muted-foreground text-center py-4",children:["No staff assigned for ",new Date(c).toLocaleDateString()]})})]},t)})}),e.jsx(Z,{open:E,onOpenChange:g,children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsx(K,{children:"Assign Shift"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Staff Member"}),e.jsxs(C,{onValueChange:t=>d({...n,staff_id:t}),children:[e.jsx(M,{children:e.jsx(D,{placeholder:"Select staff..."})}),e.jsx(A,{children:T.filter(t=>t.user_id).map(t=>e.jsxs(m,{value:t.user_id,children:[t.name," (",t.role,")"]},t.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Date"}),e.jsx(u,{type:"date",value:n.shift_date,onChange:t=>d({...n,shift_date:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Shift Type"}),e.jsxs(C,{value:n.shift_type,onValueChange:t=>{let a="08:00",i="16:00";t==="Afternoon"&&(a="16:00",i="24:00"),t==="Night"&&(a="00:00",i="08:00"),d({...n,shift_type:t,start_time:a,end_time:i})},children:[e.jsx(M,{children:e.jsx(D,{})}),e.jsxs(A,{children:[e.jsx(m,{value:"Morning",children:"Morning"}),e.jsx(m,{value:"Afternoon",children:"Afternoon"}),e.jsx(m,{value:"Night",children:"Night"}),e.jsx(m,{value:"Rotating",children:"Rotating"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Start Time"}),e.jsx(u,{type:"time",value:n.start_time,onChange:t=>d({...n,start_time:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"End Time"}),e.jsx(u,{type:"time",value:n.end_time,onChange:t=>d({...n,end_time:t.target.value})})]})]})]}),e.jsxs(Q,{children:[e.jsx(x,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(x,{onClick:I,children:"Assign Shift"})]})]})})]})};export{me as default};
